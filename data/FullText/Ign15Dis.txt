With an estimated population of more than 190 million people in 2010, Brazil is the fifth most populous state of the world and ranks number two in the Americas after the United States (314 million). It represents the 21% of the population of America, almost the 50% of that of South America. In the first census carried out in Brazil in 1872, the country had only 10 million people, which means that the population has increased by 19 in 140 years. Why such a growth? And will this rate continue? 
In fact, it is well known that population growth in Brazil has been supported by a major European immigration that reached its peak from 1900 to the 1914-1918 war. Previously, migration had been more modest, although estimates of the pre-statistical period have limited accuracy. However, it is possible to affirm that during the 17th century, European settlements interested almost exclusively the Brazilian lands of the Northeast, with two main centers: Recife and Salvador de Bahia. The expansion of settlements in the interior becomes significant in the 18th century with the use of sugarcane, which accelerates the slave trade in Africa, and the installation of farms.
In the 17th century Rio de Janeiro became a far more practical export port than Salvador, and the colonial administration was moved in 1763. In the eighteenth century, a new geographical extension of the settlement takes place inland, with the extraction of gold, which explains the population growth of Minas Gerais, Goiás and Mato Grosso. Portuguese colons flock while the slave trades continues importantly. At any rate, as Rio de Janeiro became a far more practical export port than Salvador and changes in population geography, the capital was moved in 1763 from Bahia to Rio de Janeiro. But despite the migratory flows, population numbers are still very low, given the large land area: 8515 thousand km2. They are estimated at 2,400,000 in 1808, 4,400,000 in 1819, 4,900,000 in 1823, 7,700,000 in 1854 and finally 10.1 million in the first census of 1872.

Then, immigration had a more important increase; with the abolition of slavery in 1888, the government encouraged the arrival of immigrants, due to the need for labor supply especially in an economy that is then based on the cultivation of coffee. For the entire period from 1872 to 1950, more than 4.5 million people moved to Brazil, increasing systematically the total population of the country. During the second half of the 20th century, net migration rate is less important and natural growth is the main cause of the Brazilian population growth. 
In the first census of 1872, the Nordeste was the most populated area, representing the 46.7% of the total population. In 2010, the relative demographic weight of the Nordeste, which has nine states, is only 27.8%. During the last century, the demographic center of gravity of Brazil has moved from the Northeast to the South: the Southeastern Region now has 42.1% of the Brazilian population; the most populous state, São Paulo, has 38 million inhabitants. 
The changes in the geographical distribution of the population are connected with changes in economic structures and differences in economic dynamism. Regions of the Sudeste and Nordeste have historically been the engine of the Brazilian colonial economy, benefiting from economic cycles of sugar, gold or livestock. They saw the rise, during the 1970s of the first nine Metropolitan Areas of the country. It is useful to remind that, following the 2010 IBGE census, Brazil has today 39 MAs, all of them showing a positive growth rate. They are now internal poles of emigration as witnessed by the astonishing growth of the Metropolitan Area of São Paolo, the largest economic center of Brazil, that reaches alone almost 20 millions inhabitants. 
In the rivalry between the two largest Metropolitan Ares (MAs), Rio de Janeiro and São Paulo, the latter has clearly won in the last decades. Rio (11.8 millions inhabitants in 2010) lost its role of capital in 1960 in favor of Brasília and underwent the removal of corporate and administrative services; in the same period, São Paolo (already center of the industrial sector) became the largest agglomeration of Brazil. It is still too early to foresee if the displacement of the federal capital will have important effects on the top of the hierarchy, but it is interesting to notice that since its construction in 1960, Brasília passed from 130,000 to almost 4 millions of inhabitants in 2010 showing an impressive growth rate of 7% yearly. 
The continuous growth of MAs coupled with the growth of agglomerations with at least 50,000 inhabitants makes the country’s urban transition real and substantial; this results in a particularly high urbanization rate of 84% in 2010, whereas it only reached the 44,6% in 1960. Despite this early urban transition, Brazil’s cities and their inhabitants still face stiff economic, social and environmental challenges. The road to a high level of urbanization has been exhausting and socially disruptive and finds its roots in the historical, economic, social, demographic and political contexts that shaped the Brazilian history during the 20th century. The tendency towards greater spatial mobility of the population in Brazil was already evident at the end of the Empire, with the abolition of slavery and coffee expansion of the period 1888-1930 (Balán, 1974; Merrick and Graham, 1979; Martine, 1990). Moreover, during this period the country witnessed the entrance of almost 4 millions foreign immigrants that substituted freed blacks in the production of coffee and rubber. 
The economic world crisis in 1929, and the consequent coffee crisis, contributed to the beginning of the process of national industrialization (Cano, 1985). At this stage the entrance of foreigners declined considerably, and the population of coffee plantation started to move to urban areas. Industrial development plans established by G. Vargas after 1930 required a real unification and articulation of the market. Thus, internal migration between 1930 and 1950 was directed basically to urban areas, agricultural frontiers (Paraná, Centro-Oeste, Maranhão) and especially to the industrial centers of the Southeast. National rural-urban migration reached 3 million people in the 1940s (Martine, 1990).
The new pattern of economic development adopted after 1956, based on heavy industrialization to restrict importations and inflation and to promote vertical integration in certain industries, carried on favoring the urban system that absorbed nearly 7 million people. The government gave special attention to industries considered basic for growth, notably the automotive, cement, steel, aluminum, cellulose, heavy machinery, and chemical industries. In the second half of the 1960s, industrialization accelerated and agricultural modernization began; 12.8 million people left rural areas between 1960 and 1970. These are the years of the so-called Brazilian Miracle that saw changes in the national productive structure and a diversification of the industrial park opening new urban jobs. 
The 1970s intensified these tendencies, and even within the Amazon region, migration was predominantly towards urban areas. This period marked the consolidation of large urban centers, with increasing metropolitanization and the rise of Metropolitan Areas in Brazil. Between 1970 and 1980, rural-urban migration was estimated at around 15.6 million persons. These characteristics, however, are being altered especially since the 1980s when internal migration slowed down but did not disappear. At the beginning of the 1990s there was a clear continuity of the centrally of the Southeast region, especially the São Paulo Metropolitan Area but in the last 20 years the national migratory process has changed as witnessed by the strong growth of other MAs due to intrastate migration. 
Brazilian cities are involved in a system, a self-organizing structure emerging from the interaction among cities (Pumain, 1992, 2008). Brazil shows a strongly hierarchized urban structure generated by a self-organizing process, well described by the Rank-Size rule.
We plotted the rank-size-rule concerning all Brazilian Censuses (1872-2010) including only cities with more than 10,000 inhabitants (Fig.1). 
In order to develop a proper database with the purpose to study the evolution of the whole system of cities and the interconnections between them, we have elaborated a database named DEBRA, (Demographic Evolution of Brazil), concerning the Population of the Brazilian cities and its evolution over a period of time going from 1872 to 2010 (Ignazzi, 2015), using IBGE definition for describing what is the elementary unit in the database (município), what is considered to be a Metropolitan Area (MAs), and, of course, the population of our entities.
Power trendlines on logarithmic scale are adopted to fit our data which trends upwards at an increasing rate; their values, (equations, R² and DW tests), are reported in Tab.1. The observations for analyzing the Zipf law are improved trough the Cochrane-Orcutt estimators in order to avoid serially correlated error terms by means of the software Gretl. 
Serial correlation tends to exist primarily in time series data, where the same phenomena (Population, Fertility rate, GDP, etc.) are measured in repeated time periods and panel data (where a cross-section of a population is observed more than once). In both cases, the same person or thing is surveyed in two time periods. In practice, OLS regression in the presence of serial correlation could tend to generate misleading estimates. 
First of all, we run the Durbin-Watson (DW) statistic test in order to investigate the presence of autocorrelation (also called serial correlation) in our data. This is said to exist when the error terms of any pair of observations are correlated with one another; in other words, the error terms are not independent of one another. 
The DW test measures the ratio of the sum of squared difference in pairs of residuals e to the sum of squared residuals for each observation alone: 
Gretl reports a value of the DW statistics really next to 0 in case we run an analysis with OLS for all censuses.
The value d of the test always lies between 0 and 4, d indicates no autocorrelation; if the DW statistic is substantially less than 2, there is evidence of positive serial correlation. 
As a rough rule of thumb, if Durbin–Watson is less than 1, there may be cause for alarm. Small values of d indicate successive error terms are, on average, close in value to one another, or positively correlated. To give robustness to our data we compute the Cochrane- Orcutt procedure in Gretl. This analysis runs a two-steps procedure that tries to estimate the correlation rho (ρ) between pairs of observations and uses generalized differencing to make use of this estimated correlation. Generalized differencing tends to remove the serial correlation. Only in this case we have acceptable values of the DW statistics that are all close to the acceptable value 2 (see tab.1)
The relation between population and rank is defined by a power law function R² with an exponent higher than 0.9 in all available censuses. Population data on the urban system fit well the trend curve on a log scale, even if the largest cities are more populated than expected: the 1940s mark the beginning of a rapid and inescapable growth of larger cities bringing to the present situation: the MA of São Paulo is roughly twice the size of Rio de Janeiro, the second largest MA, and about three times the size of Belo Horizonte, the third largest MA. The whole system is indeed dominated by two main MAs, (São Paulo and Rio de Janeiro), witnessing a case of urban system characterized by two macrocephalic cities. 

With its 190 million inhabitants in 2010, Brazil shows an uneven distribution of the population. A huge majority of the Brazilians live very close to the coast, leaving the interior of the country vast and spacious. There have been some changes in later years, and more people have moved further inland. However, more people have entered the cities and ensured that the densely populated areas remain full.
The highest of all are within the triangular shaped area between Rio de Janeiro, (the old capital city on the coast and main port), São Paulo, (the main industrial and financial center of the country), and Belo Horizonte, (an industrial center based upon mining in the whole area around it). This “triangulo” is the economic heart of Brazil, center for industry, business and trade. The big cities carry on being a magnet for people from all parts of Brazil and their population keeps increasing due to a combination on internal migration and high birth rate. It is not useless to notice that there are pockets of higher density around well-established Amazon River ports such as Manaus, which prospered in the late 19th century because of the rubber trade. Since 1960, the policy pursued by most Brazilian governments has been to open up the interior to develop its timber and mineral resources and encourage people to move away from the overcrowded coastal cities. Despite this, the overall population density remains very low (Fig. 2). 
Cities produce different types of goods and as such production patterns differ across the urban hierarchy. The factors leading these differences are at the core of underlying fundamentals influencing the transport costs of different types of goods, their sources of demand, and their production technology. Urban productivity is also influenced by economic composition. Urban areas show a large number of economic activities in every region of Brazil and tend to improve their productivity, but differences among them are evident and due mainly to different environments, extreme regional disparities, with the richer South and Southeast regions displaying much better socioeconomic indicators than the poorer North and Northeast.

The South and Southeast are the richest regions of the country, responsible for approximately 70% of the Brazilian GDP. Mostly urbanized, they lead the country not only in population, but also in means of transports, industries, universities, airports, ports, highways, hospitals, schools, houses and many other areas. São Paulo, Rio de Janeiro and Minas Gerais are the three richest states of Brazil, dominated by their respective MAs. In particular, computer related industries and financial services are heavily concentrated in the MA of São Paulo. Other high and medium-high technology industries are concentrated in large cities (Publishing and printing, Chemical products, Electrical and electronic machinery/equipment and Transportation equipment). The economy of Florianópolis (SC), for instance, is heavily based on information technology, tourism and services. The MA of Porto Alegre (RS) has an economy based on services, (computer, health education, tourism, retail banking) and industries, (petrochemicals, automobiles, metalworking). Curitiba (PR) is the fourth richest city of Brazil (after São Paolo, Rio de Janeiro and Brasilia); it is specialized in mechanics, chemistry, steel industry and has the most efficient means of transportation of the whole country. 
On the other hand, the northeast region, the country’s poorest area, which accounts for 28% of Brazil’s population, accounts for only 13% of total GDP. Its economy is mainly based on the production of sugar, cocoa, paper and cotton; as well as the extensive cattle breeding. But, when we leave the interior of the region we also find some exceptions: the MA of Salvador, which is specialized in the industrial sector (chemical, petrochemical, mining, automotive), tourism (is the second most popular tourism destination in Brazil, after Rio de Janeiro), and services (being the capital of the State of Bahia); Recife, capital of the State of Pernambuco and largest MA in the North of Brazil, is specialized in Information technologies and is one of Brazil’s prime business center. 
As a general rule we could say that Brazilian capitals shows an urbanization rate above the average of the respective State. Being Brazil a continent more than a country, they tend to concentrate services, high-tech industries, mechanized agriculture. Medium technology industries are relatively more concentrated in medium size cities (textile products, Pulp and paper products) and low technology industries that are usually related to natural resource extraction are concentrated in small cities (agriculture and forestry, mining and wood products). 
Brazilian Censuses are the proof of the tumultuous growth of larger agglomerations and that the spatial distribution of the Brazilian population has undergone significant changes in recent decades. 
As we previously said, official IBGE data on urban and rural census tracts are the primary source of information and show the significant shift in the demographic transition caused by urban phenomenon: during the 1940s, Brazilians living in urban areas were a minority, representing only 31.24% of the population; this percentage increased to 45.08% in the sixties and exceeded the rural population in the next decade, reaching a percentage of 56%. Since then Brazil joined the list of urbanized countries, with its population concentrated increasingly in urban areas (Fig. 3). 
The 2010 Census confirms the growing trend of urban population and the decline of the rural population. Of the total 190,732,694 inhabitants, 160,879,708, more than 84% of the population resides in urban areas, compared to 29,852,906, about 16% in rural areas. 
The essential aspect of the process of urbanization is the phenomenon concerning the Brazilian metropolis, with the urban population growth concentrated in Metropolitan Areas (MAs). Municípios, ranging in population from a few thousands to over 10 millions, are defined as being the territorially smallest administrative subdivision of the country and contribute to form MAs, a relatively large urban area covering more than one municipality with a main city organizing de facto, both economically and functionally, peripheral locations nearby. 
Results of the 2010 Population Census shows 36 Regiões Metropolitanas (MAs) and 3 Regiões Integradas de Desenvolvimento (RIDE) hosting more than 55% of the urban population, about 47% of the country's inhabitants. 

The rapid growth of urban areas has been largely discussed by a large number of authors (Martine et al, 1988; Santos, 1993; Matos, 2004, 2012; Cunha, 2005; Resende, 2004; Brito, 2006). 
In order to further investigate the Brazilian system of cities we can provide additional information on the fulfillment of Gibrat’s Law, an empirical regularity that is well known in the literature on Geography and Urban Economics. Basically, this law states that the population growth rate of cities is a process deriving from independent multiplicative shocks.
The Gibrat’s model can be tested for the Brazilian case by validation of four hypotheses: 
• Proportional Growth law: cities grow proportionately, i.e., at a stochastic rate that is independent of city size, and this gives rise to a lognormal distribution of cities. 
• Correlation between size and CAGR (compound annual growth rate): the growth rate is on average independent of the initial size of the urban agglomeration and its evolution is fundamentally stochastic, without any fixed pattern of behavior (Pumain, 1992; Bretagnolle et al., 2000).
• Correlation between consecutive CAGR: consecutive growth periods should be independent from each other in order to allow a redistribution of growth maintaining the differentiation of the system. 
• Markov chains: is a discrete-time process for which the future behavior, given the past and the present, only depends on the present and not on the past. This important class of stochastic processes is characterized by a set of states S and the transition probabilities pij between the states.
We will test the Gibrat’s law concerning the Brazilian system through the IBGE censuses from 1872 to 2010, respectively the first and last census available for Brazil (1872, 1900, 1920, 1940, 1950, 1960, 1970, 1980, 1991, 2000, 2010 censuses). It is not useless to remember here that IBGE censuses take into consideration the population of all Brazilian Municípios and not that of MAs, which have been legally and historically created during the 1970s due to the growth of major cities that absorbed neighboring Municípios into the growing sprawl forming large conurbations; as a main consequence, in our database, when a MA grows, its population is incremented with the population of the municípios absorbed. The MAs are urban entities based on the continuity of the occupied space; this criterion has been chosen for its comparative efficiency (Pumain et al., 1991; Moriconi-Ebrard, 1994; Guérois, Paulus, 2002; Parr, 2007; Batty, 2009) and in absence of data on the so-called “one hour traveling time” that refers to the time necessary to cover the distance between domicile and working place in Brazil (Pumain, Bretagnolle, 2009). 
In order to verify this hypothesis we have calculated the CAGR (Compound annual growth rate) concerning Brazilian cities and the related Standard Deviation at each interval of time corresponding to a Brazilian Census (Tab. 2).
CAGR averages are included between 0.2 and 3.4 yearly. The period 1900-1920 witnesses the most consistent growth and is closely interrelated to an astonishing number of immigrants coming to Brazil. A large number of Europeans, especially Italians, started to be brought to the country to work in the plantations of coffee. The decade 1970-1980 also shows an important growth and corresponds to a period of strong urbanization for the country as a consequence of the economic miracle of the ’60 with an industrialization concentrated in the southeastern States, notably São Paulo. The first nine MAs are also institutionalized in this period (1974).
At any rate, if the CAGR corresponds to the historical path concerning the Brazilian cities, the related Standard Deviation, measuring their distribution disparity, is not always of the same order of magnitude. This is evident starting from the 3rd period, but especially between 1940 and 2000, when the population starts to concentrate in big agglomeration on the coast accentuating the inequalities between large and small cities. 
The standard deviation, however, only says that growth is proportional to the size, but says nothing about the magnitude of changes in the system and, even if it is usually of the same order of magnitude as the CAGR, in new countries such as Brazil may have larger fluctuations. As a main consequence, we can say that the first Gibrat’s hypothesis is globally verified.
In Brazil, the size of cities does not interfere with the CAGR. The correlation coefficient calculation does not show any significant result (Tab. 3). 
The correlation coefficients are always positive but really close to zero; this does not imply a tendency to urban hierarchy reinforcement or attenuation. The 2nd Gibrat’s hypothesis is verified even if an analysis in terms of classes of cities shows a clear relation between size and growth during the whole considered period (Fig.4). Big cities have a strong tendency to grow faster while small cities reduce their importance in terms of total population. This kind of bias has been highlighted by Robson (1973) that stressed on the tendency of larger cities to grow fasten than smaller ones. 
The correlation between two consecutive CAGR is necessary to test the 3rd Gibrat’s hypothesis; the analysis of the correlation coefficient in Brazil between 1872 and 2010 shows periods of independence and others of positive correlation (Tab. 4). The model is verified until 1970: the correlation is evidently not significant between the CAGR in the firsts five periods. Positive correlations occur between the CAGR starting from 1960-1970, which corresponds to a period of industrialization followed by a strong urbanization.
The last 50 years correspond with a period during which growth is less aleatory and foster certain cities more than others. These cities showing a remarkable growth are often represented by State Capitals favored by internal migration, Metropolitan Areas that carry on attracting city dwellers, touristic centers. The case of Brasília is peculiar: the city has been created ex nihilo in the centre of the country in 1956 in order to foster a more regionally neutral federal capital and its fast growth is linked to the necessity to promote the creation in the new capital of all the necessary administrative and political institutions. As we previously said, in the 1960 census, it had a population of about 130,000; from then on, it has grown 7% yearly reaching a population of almost 4 millions in 2010. 
We can conclude affirming that Gibrat’s law is not completely appropriate to describe the evolution of Brazilian cities; in fact, the third hypothesis is not verified, but discrepancies concerning the Brazilian case or other important works (Robson, 1973; Guérin-Pace, Pumain, 1990; Moriconi-Ebrard, 1993) do not jeopardize the general validity of the model, especially its assumption of log-normal distribution of city sizes. 
Gibrat’s law can also be revealed through computations associated with Discrete-Time Markov Chains (DTMC) in order to test some characteristics concerning the population of Brazilian Cities. A DTMC model requires the following specifications: 
1. The times when the system is to be observed. 
2. The discrete states in which the system may be found.
3. The state-transition matrix showing the transition probabilities in one time interval.
Transition probabilities must satisfy the Markovian property, and every row must sum to one.
We started using our data on Brazilian agglomerations; in order to consider a regular interval of time (10 years), we developed Markov chains starting from the first modern census in 1940. First of all we developed a Transition Matrix T adopting historical data to determine the evolution of Brazilian cities belonging to different classes, from <10k (less than 10000 inhabitants) to >1000k (more than 1 million). The second step consists of tailoring a Stochastic Matrix P reporting the probabilities (percentages) for each single city to evolve from one class to another during the considered interval of time (1940-2010). 
Historical data and probability analysis determine the probabilities of replacement, (meaning the probability for a city to move to a particular class of cities), based on the considered census. The stochastic matrix P below displays this information:
Each row of the matrix describes what might occur for a city during a particular census. In order to clarify the meaning of our matrix, we can make use of the following table reporting the same results in columns and rows:
For instance, the row labeled “>1000k”, (the last at the bottom of the matrix), indicates that a city inserted in a particular class during the first census has a certain probability to reach more than 1 million inhabitants in 2010. 
The matrix is called the stochastic matrix (or transition matrix) because it shows the probability of transition from each class to every other class. We call this a Markov process when the transition probabilities depend only on the state of the system and not on the sequence of events that preceded it.
If Gibrat’s law for cities holds, then urban growth is independent from city-size; oppositely, if city-size growth in Brazil is a deterministic process, we should explore whether this generates a parallel growth with cities conserving their initial hierarchical ranks during the whole period; a convergence towards an optimal city size, with small cities growing faster than the bigger ones; or divergence, with demographic concentration towards huge metropolitan areas. 
Markov chain techniques are used to investigate the rank-size relation for Brazilian cities as well as its evolution on a decennial base, (Eaton and Eckstein, 1997, Dobkins and Ioannides, 2000, Black and Henderson, 2003). This involves the discretization of our distribution by ascribing each city to a prearranged number of groups (Tab. 5), based on its relative size (Bosker et al., 2008, Schaffar and Dimou, 2012). 
When working with Markov Chains it is often essential to know if the next state really only depends on the current state, or if it would be better to describe the process with Markov Chains of higher k order, stating that the next state depends on a sequence of preceding states; moreover, the investigation if all the states are independent of each other is an interesting fact to look at, this is often referred to zero order Markov Chain.
We have calculated that our distribution follows a homogenous stationary first-order Markov chain meaning that the law of the evolution of the system is time independent; the transition probabilities are estimated both with the maximum likelihood method (log-likelihood equal to 439.22 with) and the Bayesian Information Criterion (BIC equal to -4.44 with). 
The transition probability patterns for the Brazilian cities are driven by two features: first of all, diagonal elements, that is, the probability of persisting in the early state is high only for the second class of cities, but off-diagonal elements are mostly different than zero. Secondly, the values displayed by the last two classes, indicate a high stability in Brazilian urban hierarchies. Low volatility in urban hierarchy could be a combination of natural increase of population, (that is positive in all Brazilian MAs), and regional migration. 
The analysis performed reports the Markovian properties of our classes of cities by defining their states. There are 2 orders of possible states for a Markov chain: transient and recurrent. A state is recurrent if there is evidence that the Markov chain starting from a generic state i will return to i. A state i, on the contrary, is said to be transient if it is non-recurrent; in other words, i is said to be transient if the probability that the Markov chain starting from i will never to return to i is strictly positive. 
In the mathematical theory of probability, an absorbing Markov chain is a Markov chain in which every state can reach an absorbing state and we cannot leave that state after reaching it. This statement reveals that our system is engaging being characterized by a two absorbing states (these literally absorb cities from other classes) that could be reached in a finite number of steps; the states of our first 5 classes are transient, while, on the contrary, the last two classes are recurrent and absorbing. 
Considering our Markov chain we can number the states so that the transient states come first. If there are r =2 absorbing states and t=5 transient states, the stochastic matrix P will have the following canonical form:
Here I is an r-by-r identity matrix, 0 is an r-by-t zero matrix, R is a non-zero t-by-r matrix of absorbing states, and Q is a t-by-t matrix of transient states. 
Since the probability of not being absorbed in n steps is monotone decreasing we can also affirm that
For our absorbing Markov chain P, the matrix is called the fundamental matrix for P. The entry nij of N gives the expected number of times that the process is in the transient state sj if it is started in the transient state si.
From the canonical form we see that Q is: 
Computing we find: 
From the first row of N we see, for instance, that the expected number of times to reach state 2 to be about 5.49 times starting from state 1. 
Given that the chain starts in state si, the predicted number of steps before the chain is absorbed can be found by adding up all the entries in state rows or by formula:
where c is a column vector all of whose entries are 1. The time to absorption concerning our chain, can be represented by the following vector: 
Since we have two absorbing state, we can also compute, for each transient state, the probability bij that our chain will terminate in the absorbing state sj if it starts in the transient state si. If, is a matrix with entries bij, where N is our fundamental matrix and R the absorption matrix then:
As shown by means of this matrix, the 5 transient states have different possibilities to reach other states in the long-term. We can easily see that we are most likely to achieve class 7 than class 6, denoting the enormous potential of Brazil in concentrating population in huge cities; in particular, all cities belonging to class “200k-500k” will flow into the last absorbing state. Other classes, have a substantial possibility to reach the recurrent state “500k-1000k” but the change of joining the last class is even more considerable. 
In addition, using our computations starting from a given initial state we can calculate the transient probabilities for 20 or more steps. In our model, we have the opportunity to specify the initial state, (the classes of cities we want to examine). The transient analysis for Brazil shows that only the 3% of cities belonging to class 1 in 1940 will still be in the same class after 7 steps (70 years of operation in our model), while approximately the 35% will reach class-7 (see Tab.6 below).
The case of Brazil is peculiar: two classes of cities tend to be absorbing, others are classes of transition, but there is not any convergence between a class and its growth. Generally Brazilian agglomeration witness a tendency to move rapidly through higher classes, so even if we highlight a demographic concentration towards metropolitan areas, this does not imply that they will grow faster since a new, higher class is achieved. 
These analysis findings can be summarized as follows: growth is a stochastic process that largely rests on the test of Gibrat’s law of proportionate effect. Our test developed with Markov chains for Brazil underpins growth as a random process, independent of the size of the city: there is no optimum size for the city with respect to growth. Even though growth rates between different cities vary substantially, there is no systematic pattern with respect to size, i.e., the underlying stochastic process is the same for all cities.
In order to investigate the Brazil’s urban system, we can analyze the growth of cities through a method that distinguishes different trajectories of cities in the considered system. This method involves comparing trends observed at different time intervals, which allows us to test different assumptions.
We will examine the Brazilian system through the IBGE censuses from 1872 to 2010. Our analysis contains 531 agglomerations whose population is available for all 11 censuses. Among these we can distinguish 25 MAs and 506 Municípios. Concerning the MAs, it is not useless to specify again that we have considered the population of the core município until the 1970 census; afterwards we added the population of municípios that were gradually absorbed in the process of urbanization. 
Of course every single agglomeration has its own history and peculiarity but they will also have many similarities. The empirical analysis based on Trajpop and the method of agglomerative hierarchical clustering (AHC) supports this hypothesis grouping them in different classes of demographic trajectories. The AHC brings together the patters of evolution of cities according to relative changes in the population from one census to another and from one city to another, regardless of their size. Successively, it compares the average trajectories of each class in order to represent the evolution of the average population of the class as a function of time on a semi-logarithmic graph; as a main consequence, curve sections with the same percentage of change will have the same slope (Pumain, 2012).
First, the analysis on our sample allows us distinguishing five classes of different trajectories in which Brazilian cities are grouped. Second, large fluctuations that have characterized the growth of cities, or a particular class of cities are represented on these curves with inflections, slowdowns or accelerations; we can observe the different trajectories related to each class for Brazilian agglomerations. 
We can highlight their differences calculating, at a given interval of time, the relative weight of a class in the whole system of cities, reporting the mean of the population for each class in relation with the total urban population. So, we obtain ascending or descending curves (Fig. 5) showing a tendency to concentrate in big urban areas, with the urban population growth concentrated in Metropolitan Areas, (all belonging to class 1). 
We verified that 145 agglomerations (red line) with an average of 620,000 inhabitants in 2010 show a continuous rapid urban growth between 1872 and 2010. They expanded their average weight during the whole considered period as well as their importance in terms of total population. 
A second group of 103 agglomerations (orange line) with an average of 57,000 are also significant but their evolution in terms of total population reveals a strong decline at the end of the 19th century and again starting from the 1940s. 135 agglomerations represent the third group (yellow line, 42,000 inhabitants on average); their population carries on growing in purely demographic terms but their tendency witnesses a constant decline during the 20th century. 
A fourth group with 114 agglomerations (light blue, 27,000 inhabitants on average) shows a double tendency: they have a strong loss of population between the first two censuses, probably due to the abolition of slavery in Brazil (1888), followed by a period of relative growth (1900-1950) and a decrease both demographically and in terms of total population. The last group, (dark blue line, 15,000 inhabitants on average in 2010), is represented by 34 agglomerations; their average in the first census was 29,000. At the beginning they were extremely important concerning the total population of the system but their decline during the whole interval of time is absolute and continuous. 
The MAs are all included in the first group of agglomeration. It is not surprising to find at the top São Paulo, Rio de Janeiro, Salvador, Porto Alegre, Recife…These cities show all a strong urban growth; Rio has been the capital of Brazil until 1960 and even after that date it shows a tumultuous growth. São Paulo became the first Brazilian city in terms of population between 1950 and 1960, its area has always been important for the industry and it is today the greater financial center and the larger metropolitan Area of South America. Furthermore, many academic, scientific, cultural, artistic, administrative institutions are present in the above-mentioned cities because they are capitals of the respective Federal States. 
Population growth is not a uniform linear process over space. Within Brazil, for instance, some regions grow more rapidly than others and these differences may result in increasing gaps between densely and scarcely populated regions. Brazil offers a good example of a country with regions of very different levels of development concerning population. Nowadays the North and the Northeast in particular are much less populated than the Southern part of the country. It is interesting to notice that the 531 agglomerations considered in the previous section represented the total population of the country (9,700,000 inhabitants) at the date of the first official census in 1872. In that period the North-Northeast constituted the 50% of the total population while the South-southeast accounted for the 48%. After 138 years the situation is completely reversed: the total population of the cities under examination is almost 105 millions (more than the half of the current Brazilian population), but only the 35% resides in the Northern part. Over time, we assisted to a real population shift that has increased over the 20th century. 
We can use Moran’s I indexes and Moran scatterplots to analyze the extent and the changes of spatial inequalities among Brazilian municípios. Cities having relatively low population growth tend to be grouped together in the North-Northeast, and this tendency increases overtime with the exceptions of State Capitals and Metropolitan Areas, whereas agglomerations with higher growth rate tend to be grouped in the South of the country. 
The emergence of this polarized development could result from the existence of externalities across neighboring municípios or regions (Lopez-Baso et al., 2004). Growth at a given location may affect growth of neighbors through several channels. For instance, due to technological externalities, a locality may benefit from improved economic conditions attracting people; furthermore, if some firms in a locality have developed innovative processes, knowledge spillovers may promote the diffusion of new technologies to firms at neighboring locations. We do not need to discuss this topic here, but highlight that local economic growth may foster migration from less dynamic places (Fujita et al., 2001). The impact of this migration on both the departure and arrival locations depends on various factors, notably the migrants’ education level, the substitutability between skilled and unskilled workers in production and the state of local labor markets (Lane, Pumain et al., 2009). 
We use statistical measures of regional and local spatial association to investigate the dependence across the level of the municipios average population growth. The extent of spatial dependence of a given variable among a set of spatially distributed units can be assessed by computing a measure of spatial autocorrelation such as the Moran’s I statistic. 
Spatial autocorrelation is increasingly recognized as a major issue in population growth as well as in econometric analysis, because the levels of many socio-economic variables are not random in space. In other words, those levels depend on the geographical location of any given region. It often matters whether a region has many neighbors or is relatively isolated (Anselin, 1989; Biles, 2003; Nazara and Hewings, 2004; Autant-Bernard, Mairesse and Massard, 2007). Researchers who ignore the problem of spatial autocorrelation are more likely to estimate misguided models.
The Moran’s I, is defined as follows and is calculated for n observations on a variable x at locations i, j:
where n is the total number of our spatial units (municípios), X̅ is the mean of the x variable observed at location i, wij are the elements of the weight matrix, developed using the longitude and the latitude for each município, indicating how agglomerations i and j are spatially connected, and S0 = ∑i∑jwij is the sum of the elements of the weight matrix.
Spatial weight matrices, computed by means of the software GeoDa, are used to model spatial relationships between regions of space to calculate the Moran’s I statistic. Pure geographical distances are considered, which are exogenous, to mitigate endogeneity problems. Given the uneven size of the spatial units, the n × n W matrices used herein can capture the degree to which spatial inter-dependencies become less important with geographical distance providing the structure of spatial relationships by defining neighboring areas that should be connected. 
The results obtained using distance-based matrices are comparable across spatial scales, and these W matrices allow for measuring the extent of the spatial autocorrelation (in Km) across those spatial scales. Specifically, the element wij in the matrix is 1 if areas i and j are within “d” Km, and 0 otherwise. The minimum distance “d” to ensure connectivity for all spatial units in each spatial scale is 130 Km at the city level. On the other hand, a cut-off distance of 450 Km is adopted to focus on connectivity between cities and Federal States.
Moran index values range from -1 (indicating perfect dispersion) to +1 (indicating perfect correlation). If I=0, then there is no evidence of spatial autocorrelation, that is, there is no a positive correlation between the growth of cities and their location in the space. If Moran’s statistic is greater than zero, there is a positive spatial autocorrelation, that is, areas with high population growth values tend to be close to areas with high population growth (and vice versa). Finally, if Moran’s statistic is smaller than zero, there is a negative autocorrelation.
The interpretation of I is based on the four quadrants of a scatterplot in which for each locality we presents the relation of the variable in the location i with respect the values of that variable in the neighboring locations. 
The different quadrants of the scatterplot correspond to the four possible types of local spatial association between a region and its neighbors. Regions with a high value (relative to the mean) surrounded by regions with high values are in the top right quadrant (HH). On the opposite, regions with low values, surrounded by regions with low values are found in the bottom left quadrant (LL). At the top left, one finds regions with low values, surrounded by regions with high values (LH) and at the bottom right, regions with high values, surrounded by regions with low values (HL). 
We have computed the values of the global Moran’s I statistic for the growth rate of the population over the 1872-2010 period. Results are shown in figure 6; in all cases, we find significant positive values of the Moran’s global statistics both with a cut off equal to 130 Km and 450 Km, indicating clustering of similar values of the population growth rate. In other words, municípios with relatively high (respectively low) values of growth rate are localized nearby municípios with relatively high (or low) growth rate more than if their location was purely random. We can notice that the value of the Moran’s statistic logically decreases with the threshold distance adopted in the contiguity matrix. This is not surprising if one expects the degree of spatial association to decrease with the distance between municípios. 
Results of our scatterplot are also summarized in tables 7 and 8; it is interesting to remark that, basically, we can classify our group of cities in two different clusters characterized by North/ Northeast States and South/ Southeast/ Center West States. 
The most of the cities belonging to the first HH quadrant of the scatterplot reside in the South and Southeast, (nearly the 61% with a cut-off of 130Km and 65% with a cut-off equal to 450Km). In both cases almost more than 80% of cities located in the HH quadrant belong to classes 1 or 2. Exceptions are found both in the Northern and Southern part of the country since all State Capitals and main cities are all belonging to class 1 and placed in HH or HL quadrants. Emblematic are the States of Minas Gerais and Rio de Janeiro. In the first case, the 71% of the cities are found in the bottom left quadrant LL. 
This is mainly due to the large number of small municipios in that State but also to the peculiarity of huge cities to attract people from small agglomerations that already suffer of slow growth. This last issue is even more evident when we consider the second situation: the 45% of cities in the States of Rio de Janeiro, including the Capital and main Metropolitan Area, are situated at the bottom right (HL). This means that cities with high values of growth are surrounded by places with low values where the weakness of many municipios is in contrast not only with the opposite status of other cities but reinforced by their growth resulting from the peculiarity of attracting people from remote regions of the State and from other States. 
The contribution of the Moran’s I Statistic provided qualitative robustness to our previous results with the analysis of classes of cities. All State Capitals and Metropolitan Areas are in the right sides of the scatterplot and almost all cities witnessing continuous growth belong to classes 1 or 2 are found there. Spatial externalities in the growth process of Brazilian agglomerations revealed diverging pattern of inequalities of population growth during the period 1872-2010 and the presence of spatial autocorrelation: while the municípios in the southern part of the country and generally all Metropolitan Areas have experienced some convergence, this is not the case for the majority of places in the rest of the county. The North and Northeast regions have become spatially clustered and we can find out that the huge majority of cities in the lower quadrant LL belong to those areas. Growth inequalities between cities have tended to increase not only within the whole country but also more preponderantly within Federal States. This dichotomy is one the main peculiarity of the Brazilian system: Capitals and MAs in the North and especially Northeast have continuous population growth comparable to that of cities in the South and Southeast regions, but they dominate scarcely populated regions. This could raise some political issues since a government could be interested to populate the majority of the country and indeed the foundation of Brasilia as a Capital during the 1960s was a step in this direction, as well as, at a lower scale, the creation of the State of Tocantins in the late 1980s with its capital Palmas, but it is still to early to foresee if the switch of the political core of Brazil will affect the whole system of cities in the future. 

Focusing on the Brazilian urban system during the period 1960-2010 we can distinguish 1800 agglomerations grouped into five main classes of trajectories. Our analysis reveals five different main groups (Fig. 6): classes 1-2-3 show a continuous growing trend; the others undergo a slight or rapid decline (Classes 4-5). 
The 138 agglomerations belonging to class 1 show a vigorous ascending trend both in terms of average population for each class and of relative growth. It is not surprising that all State Capitals and 37 out of 39 Metropolitan Areas (MAs) are included in this class along with cities located in regions rich of natural resources (Coari-AM, Cruzeiro do Sul-AC, Gurupi-TO), touristic places (Foz do Iguaçu-PR, Maragogi-AL, Santarem-PA), industrial centers (Conselheiro Lafaiete-MG, Dourados-MS, Feira de Santana-BA); its curve is notably ascending especially between 1970 and 1980 due to the appearance of the first MAs; the majority of these cities was already big in 1960, (120,000 inhabitants on average), and carry on a rapid growth until 2010 reaching an average of 740,000 inhabitants. 
Class 2 consists of 297 agglomerations; among these we can find two MAs, Campina Grande-PB and Lages-SC whose population grew up in absolute terms but with a slow growth rate if compared with other MAs. The most are medium size cities whose population increased during the last fifty years, (25,000 inhabitants on average in 1960, 70,000 in 2010); their importance concerning the total population of the system during the entire period shows a regular trend. 
The third group is the most consistent: 758 agglomerations (the 42% of our sample) with an average of 36,000 inhabitants in 2010. They are significant in terms of number but their evolution in terms of total population is really meaningless when compared with the first two classes. This situation reveals a peculiarity of Brazil, a country in which a few agglomerations absorb a huge part of the total population and attract more and more labor force from structurally backward regions having many small Municípios with a scarce population. 
A further proof comes from the last two classes; the mean population of 451 agglomerations belonging to Class 4 shows a regular trend: 26,000 inhabitants on average in 1960, 25,000 in 2010. On the other hand, their average weight during the whole considered period is continuously descending as an effect of the process of urbanization with the main agglomerations attracting more and more city dwellers. 
As we already mentioned, the Brazilian urbanization is strictly connected with industrialization through internal migration: the 1960s saw Brazil’s transition from being an eminently agrarian country to becoming an industrial power; high levels of migration from the countryside to urban areas and agricultural frontiers occurred. This internal migration has been the pillar of this process of rapid urban growth that has happened throughout Brazil in recent decades. Internal migration flows were heaviest in movements from the Northeast to the Southeast for the concentration of industries mainly in the southern states. 
Class 5, (19,000 inhabitants on average in 2010), is represented by 156 agglomerations; their average in 1960 was 32,000. This trend witnesses a continuous and negative decline during the whole period concerning both the average of the population for each class and in terms of total population. In this class we mainly find small isolated municípios, usually located in the north and in the center of the country. They had mainly an economy based on enormous plantations and suffered from the above-mentioned process of urbanization and economic stagnation due to the high inflation rate and the fall in coffee prices in the second half of the 1950s and early 1960s.
We have also calculated the values of the global Moran’s I statistic for the growth rate of the population of 1800 cities considering the last 50 years (1960-2010). Results are plotted in figure 8 revealing an attenuation of spatial autocorrelation in Brazil when examining a larger sample of cities within a shorter interval of time. 
At any rate, we can still find positive values of the Moran’s global statistics both with a cut off equal to 130 Km for evaluating the spatial autocorrelation of cities belonging to the same Federal State, and with a cut off of 450 Km for the analysis of cities placed in different often isolated States. The general rule that municípios with relatively high values of growth rate are placed nearby municípios with relatively high growth rate more than if their location was purely random is still valid.
Results of our scatterplot are also summarized in tables 9 and 10; it is engaging to observe that classifying our group of cities in two different clusters (North/ Northeast States and South/ Southeast/ Center West States), results are quite different when examining the situation in detail. The most of the cities belonging to the first HH quadrant of the scatterplot still reside in the South and Southeast, (nearly the 58% with a cut-off of 130Km and 59% with a cut-off equal to 450Km) but we have a huge increase in the percentage of cities within the LL quadrant.
In our analysis we have considered 1800 cities that collectively represent the almost 86% of the Brazilian population in the official 2010 IBGE census 814, of which belong to Northern/Northeastern States; with a cut off equal to 130 km we found 189 cities in the HH quadrant (23%), 359 in the LL quadrant (44%), 162 in the HL quadrant (20%), 104 in the last quadrant LH (13%); increasing the cut off to 450 km we observe 156 cities in the HH quadrant (19%), 396 in the LL quadrant (49%), 195 in the HL quadrant (24%), 67 cities in the LH quadrant (8%). In both cases, (cut off equal to 130 and 150 km respectively), the majority of Northern/Northeastern cities are in the LL quadrant but all Capitals and Metropolitan Areas are in the HH or HL quadrant meaning that they are growing centers thanks to a natural increase of the population but also attracting people from nearby regions. 
On the other hand, we find 986 cities in South/Southeast/Center West States; considering a cut off equal to 130 km we detected 259 cities within the HH quadrant (27%), 437 in the LL quadrant (44%), 169 in the HL quadrant (17%), 121 in the last LH quadrant (12%). An increment of our cut off (430 km) leads to a situation in which we find: 271 cities in the HH quadrant (28%), 376 cities in the LL quadrant (38%), 157 cities in the HL quadrant (16%) and 182 cities in the LH quadrant (18%). Even for Center and Southern States the majority of the cities belongs to the LL quadrant. Even in this case, Capitals and Metropolitan areas are all in the right side of the Moran scatterplot (HH and HL quadrants). 
This fact essentially marks a peculiarity of Brazil: the whole system is marked by a division between cities and States growing more than others, but this is quite normal when dealing with a country distinguished by an enormous territorial extension. The system is clearly dominated by large metropolitan areas with two main cities, (notably São Paulo and Rio de Janeiro), always at the top of the hierarchy since the first census in 1872, with the handover of the former Capital in favor of São Paulo during the 1950s. As a matter of fact, the Brazilian system should appear as a sleeping giant that reached its steady state but nothing seems to be further from the truth: simply extending our analysis at the top-twenty of the hierarchy we immediately notice that its evolution is strongly dynamic: cities like Manaus, Florianopolis, Vitoria, Goiânia, that in 1960 counted around 100,000 inhabitants exceeded 1,000,000 in only 50 years, not to mention the case of Brasília whose overwhelming growth is strongly related to its institutional function of Federal Capital. 
In addition to this mobility concerning the upper side of the hierarchy, confirmed already performing the Markov Chain analysis in order to support the validity of Gibrat’s law, we stress that the spatial analysis performed in a shorter interval of time, but with a larger sample of cities states another important but often omitted singularity of the system: the presence of a huge body of small cities whose growth is mainly slowed down by their geographical location, (being the most of them isolated municípios in remote part of the country), or by the presence of huge cities offering more opportunities fostering migrations. The Brazilian system of cities is a complex, self-reinforcing system, marked by the innate dichotomy between small and big: if it is true that the system is strongly dynamic, it is also a matter of fact that huge metropolitan areas urban areas are magnets that attract people from their “natural reserve” of small towns and for this reason we should not undervalue their importance when examining the evolution of the whole system. 

Our analysis concerning the evolution of the Brazilian agglomerations endeavor to examine the system of cities from a long-term perspective. It is clear that the history of Brazilian urban growth is thus closely intertwined with the economic, social, political and demographic transformations that the country has undergone, especially over the last century (Abreu, 1998). 
Although Brazil finds itself at a mature stage of its urban transition, at least from a demographic perspective, it is still experiencing appreciable absolute growth in some cities, particularly on the periphery of larger ones (Martine, 2009). 
A methodological aspect should always bear in our mind: Brazil is a huge and very diverse country; a more comprehensive review of its urban trajectory would require delving into regional specificities and case analyses. To exaggerate a point, the perennially poor Brazilian Northeast of the past provides a stark contrast to the developed-country ambiance of the Southeast, and particularly of its most advanced state, São Paulo.
A main reason for the ascendancy of the state of São Paulo (and later of the city of São Paulo) in the 19th century was its ability to adapt to the abolition of slavery, shifting away from slave labor and attracting a large number of immigrant laborers to its coffee plantations. More importantly, the city representing the current economic core not only of Brazil, but also of the whole South American continent, exerted a striking attraction on immigrants by reason of their professional skills strongly necessary in a fast development country lacking a traditional middle-class et above all of qualified urban workers (bricklayers, artisans, retailers etc.); these last will foster a new urban growth in a system shifting from slavery to modernization (Monbeig, 1953, Vasconcelos, 2009). As we already said, about four million immigrants are estimated to have entered the country between 1880 and 1930; some 70% of these arrivals settled in the state of São Paulo (Merrick and Graham, 1979, 65-92). 
To recapitulate, Brazil’s precocious urban transition can be attributed to a combination of factors. At the beginning, the model of settlement imposed on this huge country by the Portuguese colonizers, involved in the defense, the exploitation of different riches in the internal regions and the dominance of the landowning classes led to the formation of a strong but geographically scattered and disconnected arrangement of cities along the coastline. The abolition of slavery, the induction of immigration, the modernization of productive processes and the emergence of new relations of production in a vastly successful coffee cycle in the state of São Paulo all helped to create a dynamic new growth pole which would set the stage for a rapid urban transition that began in the last decades of the 19th century.
The 1930s saw an economic crisis that provoked an unprecedented debt crisis; as a consequence, the Federal Government led by G. Vargas, promoted an import-substituting industrialization, (the so called ISI), aiming to replace foreign imports with domestic production.
In this context, the stimuli of wartime production and of State intervention in key sectors, including transportation and communication, later combined with the acceleration of demographic growth, favored an intense process of urbanization and urban growth that persisted for half a century (Martine, 2009). The modus operandi adopted by the leadership of the military regime at the power from the 1960s to the middle of 1980s, led to an agricultural modernization that provided further stimuli to urban migration during the pick of Brazilian demographic growth. 
Taken altogether, Brazil’s urban transition was enhanced on the basis of a multinucleated urban system derived from the colonial period that saw the rise of a more modern dynamic growth center located in the São Paulo-Rio de Janeiro area. ISI based on the dynamism of the economic region dominated by the city of São Paulo has been necessary to integrate these two systems. Despite political discontinuities, the model was reinforced throughout the period 1930-80 and was at the very heart of profound social, economic, political and demographic transformations.
Since migrations flow preferentially towards the more dynamic regions, it was unavoidable that the Sudoeste region, in which São Paulo and Rio de Janeiro are located, showed the fastest growth. But changes affected the entire country. The consequence was the early and rapid transformation of a rural/agricultural nation into an urban/industrial one (Santos, 1993). 
In concluding this section, it is interesting to observe that, paradoxically (though understandably), explicit government opposition to urbanization and to population concentration, from roadblocks to integrated migration policies, has had the opposite effect. 
Various efforts were made to move migration to unoccupied and undeveloped rural areas, first to the Paraná frontier, then to the Center-West region, and finally to the Amazon region, because Brazilian Governments wanted to homogeneously occupy the whole available territory. Indeed, waves of colonization directed to these regions actually generated a much larger growth in urban, rather than rural, population (Martine, 1988, 1990). As already discussed, a key initiative was the relocation of the Federal Capital from Rio de Janeiro to Brasília, in the interior of the enormous unpopulated territory. It also fostered the construction of a network of highways connecting Brasilia to the Center-South and, later, to the vast and mainly unoccupied Northern region. 
Government intervention aimed at the intensification of industrialization inevitably reinforced the nucleus of its original growth. Thus, as urbanization and ISI progressed, the city of São Paulo and its surrounding regions assumed a hegemonic role in the national economy; conversely, the Rio de Janeiro region showed a relative decline, due to a combination of stagnating economic conditions and, subsequently, to the transfer of the capital city to Brasilia. 
The inability to control population movements is a consequence mainly due to the very nature of the process of urbanization that shaped the Brazilian system of cities. These should be always treated under the aegis of complex systems; any exact prediction is impossible and any attempt to control the system could trigger unwanted consequences. However, when dealing with long-established territories it is possible to explore the system, describing its main features like we have done for the Brazilian case and exploring plausible scenarios about its future evolution.
