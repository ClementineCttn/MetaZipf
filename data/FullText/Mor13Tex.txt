Economic activity is much concentrated in cities. As cities have different sizes, regional economists and urban planners, have always endeavored to understand and explain the dynamics of city size distributions and the coexistence of cities of different sizes. 
It seems to be at least three stylized facts. First, the distribution of cities sizes is a way to approximately study the distribution of economic activity. Second, urbanization is closely associated with economic growth. Third, earnings are positively related to city size which is generally regarded as an evidence linking productivity and city size. 
There is a huge literature as to the form of the distribution of size of cities in urban systems. Apparently, there is an empirical regularity in the distributions of sizes of cities belonging to the same region or country. This regularity is known as Zipf’s Law or rank size rule. 
Although the rank size rule is a mere description of the data it seems that it has a close association with the economic development. Hence, Zipf's law would be a result of economic development and one reached it would remain in the long run. 
There is a vast literature on testing the empirical validity of Zipf's law and more recently on the econometric pitfalls of its estimation and testing. As far as we know very few are concerned with urban population in Brazil particularly using data prior to 2000. So, in this paper we test the validity of Zipf's Law for urban population in Brazil using data from municipalities in the period 1970-2010. 
An important limitation of the Zipf’s Law approach is that its nature static and “stiff” does not allow any insight on what goes on in the inside of the size distributions, nor on its mobility in time and space. Therefore, in this paper we resort to the Markov chains approach to analyze the dynamics and evolution of size distribution. We also introduce the spatial context in the analysis through a combination of some spatial analysis methods with the Markov chain approach. This is referred as in Rey (2001) as Spatial Markov chain and enables us to verify in what measure the population growth of a locality is related to the growth of its neighbors. We use decennial census data for the Brazilian urban population in the last forty years, 1970-2010. 
Our paper is composed of three sections besides this introduction. In the next section we provide a brief review on Zipf's Law and present some empirical results found in the Economic Literature. We also address some econometric pitfalls in the estimation and testing of Zipf's Law by the usual methods. In section 3 we explain the dynamic approach of Markov chains analysis both traditional and spatial as adopted in this paper. Section 4 presents a description of the data and methodology. In this section we present and discuss the empirical results obtained with our data. Finally, we conclude and suggest some extensions for further work. 
Since Auerbach’s paper published in 1913, several research papers have been done indicating that the city size distribution is well approximated by a Pareto distribution with one parameter. Georges Zipf, in 1949, refined this proposition and suggested what came to be known as Law of Zipf or rank-size rule. The rank-size rule emerges from the accumulated Pareto distribution where the size of the population of a city is a random variable P with a realization p such that the probability of finding a city with population lesser than p is given by an accumulated Pareto distribution of the type: 
Therefore, the probability of finding a city with population bigger than p is given by: 
For, we have
taking logs of both sides:
where r is the position (rank) and p is the population of the city. If the coefficient a is equal to 1, the multiplication of the population for the rank is a constant (lnA) which means a “parallel growth”, that is, cities became bigger but the distribution of sizes remained unchanged. In other words the process of urbanization was due mainly to the increase of the already existent cities. The parameter can be considered as a measure of inequality, because the higher its value, the less will be the inequality in the size distribution and vice-versa. The Pareto exponent can also be interpreted as a convergence indicator. Countries or regions with polarized and asymmetrical urban structure would have a coefficient, whereas a region with symmetrical cities and decentralized urban structure would have.
A way to test econometrically the rank size rule (equation 4) is through the equation: 
where rit is the position (rank) and pit is the population of the city i in the period t and are the innovations. Gabaix and Ioannides (2003) performed Monte Carlo experiments, and found that OLS biased downward in small samples. The bias decreases with increasing sample size, but still the OLS underestimated standard errors can cause coefficient estimates that are very close to one to be rejected. This is caused by the ranking procedure which creates positive autocorrelations among residuals. Furthermore, when dealing with urban agglomerations the spatial nature of the data has to be considered. 
Two kinds of effects are common in spatially aggregated data, spatial dependence and spatial heterogeneity. Spatial dependence leads to spatial autocorrelation and arises when values of a variable at neighboring localities are similar. Spatial autocorrelation violates one of the most important assumptions of statistical analysis, the independence between observations. Spatial heterogeneity refers to the dissimilarity of values in neighboring locations and results in structural instability of the regression coefficients and error variance in space. Traditional econometric techniques are usually adequate to deal with spatial heterogeneity. However, in the presence of spatial autocorrelation traditional methods as OLS and Instrumental Variables may lead to inconsistent and/or inefficient estimates. Several procedures to test for the presence of spatial autocorrelation and to estimate models with spatial data were developed by Anselin (1995), Anselin and Bera (1998), Anselin and Florax (1995), Kelejian and Prucha (1998), Piras (2010) (see also Anselin, Florax and Rey, 2004, for a review). 
Nishiyama et al (2008) showed that in the tests for the validity of the rank size rule, the t- statistics explodes asymptotically under the null, creating a huge Type I error. The authors provided new critical values, conceptually similar to unit root tests, to test the Pareto parameter and the significance of the quadratic term in quadratic regressions for the rank size rule. The new proposed thresholds are much higher than the usual t-values and with them the authors concluded that the rank size rule holds for most countries in which it was rejected in previous studies. 
Empirical studies also show that the estimates of the Pareto coefficient are sensitive to the definition of the unit of analysis. Estimates using data from cities are usually higher than with data from urban agglomerations. 
Dobkins and Ioannides (2001), analyzed decennial census data for U.S. metropolitan areas (MA) from1900 to 1990. They found Pareto coefficients close to 1 but decreasing towards the end of the period. These results together with the kernel estimates performed by the authors raised doubts on the validity of the rank-size rule. Black and Henderson (2003), analyzed decennial census data for the same period for the U.S using a different definition of MA. They found the Pareto coefficient for the full sample in all years around 0.85 and lower values in some latter years as 1970 and 1990. According to the authors, their results for the full sample gave modest support to the view of increasing urban concentration in recent decades. As the estimates are sensitive to the sample size the authors re-estimate the equations for the top one third of cities. This time they found the Pareto parameter larger in every decade, varying from around 1 in the early years to 1.18 in 1990 which would suggest decreasing urban concentration over time. 
Ruiz (2005) compared urban structures for Brazil and USA for different groupings of population in 2000. For the 100 prime urban agglomerations, the Pareto coefficient was 0.89 for Brazil and 1.04 for the U.S, indicating a higher polarization for Brazil. The author also found that when the small cities were progressively excluded from the sample, the Pareto coefficient increased for the USA (as Black and Henderson, 2003), and decreased for Brazil. While in USA it ranged from 0.68 to 1.22 (100% and 50% of the urban population respectively), in Brazil, it varied from 0.74 (100%) to 1.03 (90 %), shrinking to 0.87 when the sample included 50 % of the urban population suggesting an increasing urban concentration on the top rank cities. 
The literature is much vaster than discussed above. There still yet estimations for France (Guérin-Pace, 1995), Spain (Lanaspa et al. 2002), China (Anderson and Ge, 2003), comparing several countries at a time (Rosen and Resnick, 1980; Soo, 2005, Ruiz, 2005) and so on. The average of estimates in these studies varies from 0.8 to 1.96. 
Gabaix and Ioannides (2003) suggest that Zipf’s law with a coefficient around 1 describes well the regularity of empirical size distributions and recommend that a value between 0.8 and 1.2 should be included among the criteria to judge the success of urbanization theories. 
Many authors are concerned with the lack of credible theoretical models that reproduce the rank-order rule (Gabaix and Ioannides, 2003). This gap in economic theory is a significant matter of debate. Apparently, the form of the distribution, per se, is not enough to extract sound theoretical explanations. The reason is that distributions highly skewed which are characteristic of most urban systems can be related to several explanatory processes and do not have an unambiguous correspondence with any theoretical explanation (Pumain, 1997). 
Even the NEG, that provides a credible theory to explain how persons (and activities) take their location decisions, does not manage to reproduce the rank order rule. The authors admits this in page 225 of their book.. “at this point we have no resolution to the explanation of the striking regularity in city size distribution. We must acknowledge that it poses a real intellectual challenge to our understanding of cities...”. 
Gabaix (1999) has derived a statistical explanation of Zipf’s law for cities. He shows that if different cities grow randomly with the same expected growth rate and the same variance (Gibrat’s Law), the limit distribution of city size will converge so as to obey Zipf’s law. 
The Zipf's Law regression approach is attractive as a first description of the data, but as Fingleton (1997) has pointed out, it lacks the richness and flexibility of the Markov chain approach. Therefore, in this paper we also use the Markov transitions matrix in order to shed some light on the dynamics and evolution of population distribution over the decades. 
The Markov chain approach has been used in studies of urban systems to describe the growth and mobility of the urban population into n different size classes or "states", which provide a discrete approximation for the population distribution. 
Be the vector containing the population distribution in n different states at time t; if the state of a system in time depends linearly only on the state in the previous period t plus a random component the process is a Markov chain of first order. In a second order process the state in would depend on the states in t and assuming initially that the Markov chain is first order case we have: 
where M is a matrix representing the transition between the two states: 
and is the probability of a municipality changing from class i in period t for class j in Thus we have: 
The matrix M can be estimated using the observed frequencies of changing classes from one period to the next. Following Anderson & Goodman (1957), the maximum likelihood estimator for is: 
Where are the total number of urban municipalities moving from class i in period to class j in t. if the transition matrix is stationary, then 
and it can be shown that the matrix M is regular, ie there is an s such that has no zero entries and the distribution of the different classes tends to a stationary or ergodic distribution. The stationary distribution is an eigenvector of the transposed matrix M associated to the unit eigenvalue. 
Any transition matrix may suggest a Markov model but the partial dependency property embedded in it, referred as the Markov property, causes the Markov chain inappropriate to analyze independent events. This underscores the need for testing for this property. 
In order to test the order of the Markov chain as well as the order of the process we use the methodology proposed in Collins (1975) which is based on the Maximum Likelihood Criterion developed by Anderson and Goodman (1957). 
The LR test for the Markov property is: 
Where
And 
Where are the total number of urban municipalities moving from class i in instant to class j in the instant t over all observed transitions.
To test order 0 versus order 1, the null hypothesis is for all is tested against the alternative hypothesis for any The required statistic is which under the null hypothesis has an asymptotic Chi-square distribution with degrees of freedom, where n is the number of classes. From the equation (2) we obtain: 
The LR test for the null hypothesis of a first order chain against a second order is as follows: 
Where are the total number of urban municipalities moving from class I in instant to class in instant and to class in the instant t over all observed transitions. The null hypothesis is for all is tested against the alternative hypothesis for any.
The required statistic is which under the null hypothesis has an asymptotic Chi-square distribution with degrees of freedom, where n is the number of classes. 
From the equation (2) we obtain: 
The LR test for the null hypothesis of a first order chain against a second order is as follows: 
Where are the total number of urban municipalities moving from class i in instant to class j in the instant and to class k in the instant t over all observed transitions. To test order 1 versus order 2, the null hypothesis is for all is tested against the alternative hypothesis for any
The required statistic is which under the null hypothesis has an asymptotic Chi-square distribution with degrees of freedom, where n is the number of classes. From the equation (4) we have: 
The Markov chains approach has been used by some authors to characterize the mobility of the size distribution of cities. Eaton and Eckstein (2007) analyzed data from 1876-1990 and 1925- 1985 for France and Japan respectively using a Markov Chain approach. The transition matrices for both France and Japan had large values for the diagonal and many low values and zeros in the off- diagonal terms. The diagonal terms increased with the relative size for France, while for Japan they were higher for both ends and smaller for medium sized cities. This high persistence was interpreted by the authors as evidence of a 'parallel' growth, pointing to the validity of Zipf’s Law. 
Black and Henderson (2003), in their analysis of the U.S. urban system found similar results. Only the diagonal elements and the immediately off-diagonal were significant, indicating that in a decade cities moved up or down only one category (state) in the size distribution. They also found that the diagonal elements were higher for the two higher states. Similar results where found by Le Gallo and Chasco (2007) and Lanaspa et alii (2003) for Spanish cities. 
However, most studies on size and growth of the cities using Zipf's Law and Markov chains fail to take into account the spatial nature of the data. Space matters not only because the spatial organization of cities and their surroundings are important to their levels of economic activity but also because spatial effects may invalidate the results of analysis using spatial data. 
Two kinds of effects are common in spatially aggregated data, spatial dependence and spatial heterogeneity. Spatial dependence leads to spatial autocorrelation and arises when values of a variable at neighboring localities are similar. Spatial autocorrelation violates one of the most important assumptions of statistical analysis, the independence between observations. Spatial heterogeneity refers to the dissimilarity of values in neighboring locations and results in structural instability of the regression coefficients and error variance in space. Traditional econometric techniques are usually adequate to deal with spatial heterogeneity. However, in the presence of spatial autocorrelation traditional methods as OLS and Instrumental Variables may lead to inconsistent and/or inefficient estimates. Several procedures to test for the presence of spatial autocorrelation and to estimate models with spatial data were developed by Anselin (1995), Anselin and Bera (1998), Anselin and Florax (1995), Kelejian and Prucha (1998), Piras (2010) (see also Anselin, Florax and Rey, 2004, for a review). 
The spatial dependence also causes problems in Markov chains based analysis because it overlooks the "sticky" mobility between neighboring localities (Fingleton, 1997). The spatial autocorrelation also overestimates the significance of the statistical tests for the goodness-of-fit in the Markov transition matrix (Fingleton, 1997). 
Rey (2001), suggested a procedure that integrates the methodology LISA (Local Indicators of Spatial Association) developed by Anselin (1995) with the Markov chains. The main motivation for the LISA (Local Indicators of Spatial Association) statistics, comes from the fact that global indicators such as Moran's I and Geary C, ignore the existence of local patterns of spatial autocorrelation, which may lead to misleading conclusions on the existence of spatial autocorrelation in the data. 
The LISA breaks down global indicators allowing the assessment of the individual contribution of each observation to the global statistic. In this paper as in Rey (2001), we use statistics derived from the global statistic Moran's I. A local Moran statistic (Anselin, 1995; Rey, 2001) for an observation i is defined as: 
Where zi is in deviations around the mean and is the spatial lag for region i calculated as a 
weighted average of the neighbors with the weights taken from the spatial weights matrix. Nonzero values in a given row of the weights matrix indicates the neighbors for the observation associated to that row. The sum of local Moran is the global Moran’s I. 
The local Moran is defined for each observation according to the average of its neighbors. Thus, positive spatial autocorrelation means similar values (high or low) to the neighbor’s average while negative spatial autocorrelation indicates values significantly higher (or lower) when compared to the average of the neighbors (high-low or low-high). This leads to a classification system consisting of four mutually exclusive categories, HH (high-high), LL (low-low), HL (high-low), LH (low-high). Rey suggested an integration of this system of classification into a Markov transition matrix. 
Thus, starting from an initial period (t0) with four categories there are four possible transitions t1 for each state in t0. The municipality and the average of its neighbors (spatial lag) can: a) remain at the same state as t0, ie the transition is of type zero, b) the municipality changes state whereas the neighbor remains unchanged, referred as type I transition, c) the neighbors change state while the municipality remains unmoved, the transition from type II, d) both municipality and neighbors transition to different states or type III transition. Transitions of type III can be further divided in two categories, IIIA which occurs when both move in the same direction and IIIB when they move in different directions. 
Rey’s procedure for the integration of the local Moran into a Markov transition matrix is summarized in Table 1. 
Rey (2001) also suggested a procedure based on a modification of the traditional matrix Markov through a geographic conditioning on the spatial lag. Thus, the Markov transition probabilities are conditioned on the initial state t0 of the average of the neighbors. Table 2 shows an example of this Spatial Markov matrix with three initial states for the spatial lag: population below the average, average and above average. 
The influence of spatial dependence in the transitions is carried out by comparing the observations not conditioned on the bottom of the table with the corresponding one in the conditioned matrix. Thus, for example, if it means that the probability of a municipality moving upwards when it has a neighbor with low population is less than the probability of moving upwards (independently of the neighbors). That is, the presence of a less populous neighbor lessen the likelihood of this city grow. Similarly, would mean that the presence of neighbors densely populated would increase the probability of increasing the population. 
Brazil is divided in States broken down into municipalities which is a collection of settlements or “districts” under the domain of a core city which is typically the biggest city in the municipality. This city is the urban nerve center of the municipality. Every single area in Brazil, albeit remote or wild, is in the territory of some municipality. In many cases the core city in a municipality is a semi- rural settlement with a very small population. In a very few cases a municipality possesses only one city. 
In this study we use census data for urban population of the Brazilian municipalities in the period 1970 to 2010. The urban population of the municipalities was used as a proxy of the population of their core cities, as in most Brazilian cities, the core city of the municipality contemplates most of the urban population. To estimate the regression models we used the full sample of municipalities in all decennial censuses from 1970 to 2010. For the transition matrices we use the 3949 municipalities of the census 1970 for all the censuses up to 2010. 
Table 3 presents the number of municipalities, the total population, the means of each decade and the percentages of total population covered by our sample. Column 5 shows the percentages corresponding to the sample we used to calculate the Markov transition matrices in each decade and column 6 the percentage of the population corresponding to the municipalities above average. The 3949 municipalities of our sample cover more than 92% of the total population so that we may assume letting out a number of very small municipalities. The total urban population increased from 52 to almost 161 million inhabitants in this period and the average more than doubled, from nearly 13,000 in 1970 to 29,000 inhabitants in 2010. There is a predominance of urban agglomerations sparsely populated as only 13-14% of the municipalities have above-average urban population. 
Table 4 and 5 presents our estimates for the five periods, 1970, 1980, 1991, 2000 and 2010. The OLS estimates are inefficient since tests for heteroskedasticity (Koenker and Basset, 1982) and LM tests for spatial errors were highly significant in all models. LM tests for the joint presence of spatial error and spatial lag where also significant in most models for the full sample, which causes OLS estimator to be also inconsistent. For this reason, we used the sphet procedure implemented by Gianfranco Piras (2010) for estimating the spatial models with heteroskedastic innovations. The sphet is based on methodologies implemented in Kelejian and Prucha (2007, 2010) and Arraiz et al. (2010). Estimation procedures are based on generalized moments (GM) and Instrumental Variables (IV) methods. The unrestricted model is estimated (with spatial lag and spatial error) and if one (or both) of the spatial coefficients turns out statistically non significant one can estimate the reduced model. 
We estimated OLS and Spatial Models for the full sample as well as models including dummy variables for municipalities above average, referred as Above Mean in the tables. A plot of log of rank against log of population indicated a relationship closer to quadratic than linear, so we also estimated regressions including a quadratic term for the log of the population. In the quadratic model, a coefficient statistically different from zero for the quadratic term would be an evidence of 
departure from Zipf's law. However, the Monte Carlo experiments performed by Gabaix and Ioannides (2003) found a high probability (increasing with sample size) to find the coefficient statistically different from zero even if Zipf's law holds perfectly. This happens because of the underestimated standard errors supra mentioned. 
Our estimates for the Pareto coefficient were quite different for OLS and spatial models suggesting the inconsistency of OLS estimates in the non-spatial models. Standard deviations for spatial estimates were 4 to 10 times smaller than OLS. Thus, standard significance tests for the OLS coefficients rejected Zipf's Law at any significance level for all years. The average of the coefficients of the spatial models was around 0.74 for the entire period and statistically different from one in each period. We can observe a decrease in the value of the coefficient from 0.79 in 1970 to 0.70 in 2010 (both significantly smaller than one), suggesting an increase in urban concentration in the most recent period. The estimates were quite different for models with dummies for municipalities above average. 
For these municipalities (around 14% of total), although the OLS estimates were very close to one, Zipf’s law was rejected in all periods but 1970. The t statistic was highly different from one. As municipalities above average ranged from 500 in 1970 to 772 in 2010, we use the critical values provided by Nishiyma et al (2008) for the t-statistics for 500 observations (2008) shown in Appendix A. None of the periods for both OLS linear models and spatial models rejected the Zipf law for cities above average. 
The quadratic terms in quadratic regressions were significant in all OLS models for the full sample as well as for the sample above mean even when considering the new critical values, therefore rejecting Zipf’s law. For the spatial models we rejected the null hypothesis for the quadratic term using the standard t values and did not reject using Nishiyma’s critical values. 
In short, when we consider the full sample of municipalities the Pareto coefficient is much smaller than 1, which features a polarized and asymmetric urban structure. However, results for those municipalities with population above the average show a less concentrated urban structure and seem to confirm Zipf law. None of the quadratic models confirm Zipf’s law with standard t critical values. For the spatial models Zipf’s law is confirmed when using Nishiyma’s critical values. Ruiz (2005) found similar results for Brazil, with a coefficient of 0.74 for 2000 when it considered 100% of urban population and between 1.03 for 90. Our value was 1.06 for a sample with 86% of urban population. 
Black and Henderson (2003) obtained an average of 0.85 for a full sample of American cities of the USA in the period 1900 to 1990 and values superior to 1 the top one-third U.S. Hence, comparing to the US, Brazil shows a more polarized urban structure and cities suggesting a decrease in concentration for largest cities. 
In Table 6 we have the spatial transitions using the classification system developed from the LISA statistics. The first result that stands out is the increasing mobility in the long run. For example, in a period of 10 years the probability of remaining in the same size for the pair municipality-spatial is 96.2%. In a 40 years interval this probability falls to 88.5%. The most frequent type of transition in the short term is the type I, where the municipality moves and the average of the neighbors remains unchanged. 
However, this behavior changes as the time interval increases, whereupon type II transition predominates over type I. In type II are those municipalities where the urban population remained unchanged while the neighbors move. Two sub-groups within this group seems interesting to examine closely: those whose high relative population propelled the neighbors and those with low relative population that dragged down their neighbors. 
We did a inspection to get to know what kind of municipality belonged to these two sub groups. We found 39 municipalities in the first group, most of which already had a significant urban population in 1970, including eleven state capitals, seven in the Northeast, three in the Southeast and one capital from the South. Most likely, the size of the urban population of these cities has boosted the growth of their neighbors. This is corroborated by the spatial transition matrices in Table 9 below. In the second sub group we find sparsely populated cities with 67 small towns, most (46) in the interior of the Southeast and South regions (46 and 20 respectively). In this case what happened was probably a drop in economic dynamism of the region surrounding these cities. 
For the analysis of Markov chains we constructed three size distributions with different normalizations. In the first we normalize the population on national average, in the second the reference was the region’s average and in the third we conditioned the size on the average of the neighbors (the spatial lag). The distributions were discretized using powers of two, implying that the limit population of one class is the double of that of the previous class. Appendix B describes our discretization in detail. Besides allowing a better intuition of the meaning of the classes this discretization performed better in the dependence and first order tests. The value of the LR test for the null hypothesis that the transition matrix is of “zero” order (Markov property) was which rejects the independency of the process. The null hypothesis that the chain is of first order is not rejected as the value for the LR statistic was. 
The average of the transitions from 1970 to 2010 for all three normalization are presented in Table 7. 
In the first column we have the number of size classes and in the second the total number of transitions starting points in that size class. Thus, for example, in the four transition periods there were 13,637 times in which a municipality occupied the class (less than average). The diagonal elements of the matrix are extremely high comparing to the off-diagonal elements particularly for the two classes in the extremities. This indicates high stability and low mobility inter-class over time. Therefore, the probability of remaining in the same size class is much larger than the probability of increasing or decreasing size. 
Another point to note is that the off-diagonal elements that are different from zero in the transition matrix are around the diagonal. This shows that, with rare exceptions, radical changes in population size are uncommon. 
This kind of movement of size classes into the same class in the next decade (with the highest average population) seems to indicate the parallel growth mentioned by Eaton and Eckstein. For the intermediate size classes (except 4 to 8) the probability of decreasing size is higher than increasing. 
This low interclass mobility was also observed in the other two matrices. Conditioning on large regions showed no substantial differences from the traditional non-spatial matrix. Apparently, this was a limited way to take into account the spatial dependence. 
On the other hand, when the regional conditioning was on the spatial lag, we observed a lower concentration and increased mobility among classes. The movement toward the lower classes was more pronounced as for all the intermediate classes the downward movement was more than twice the upward. 
In Table 8 we have the initial and the ergodic distribution for the matrix normalized by Brazilian average population. 
The ergodic distribution show a decreasing number of small municipalities (with urban population less than average). In 1970 around 87% of the municipalities had urban population smaller than the average. The participation of these municipalities should gradually decrease until it reaches 55% of the cities. The sharing of the municipalities with population greater than or equal to 4 times the average and less than 8 times the average should increase from 1.4% to 9.5%. Municipalities with population greater than or equal to 8 times the average and less than 16 times the average should increase from 1% to 11.4%. Finally, the municipalities with population greater than or equal to 16 times the average should increase from 0.6% to 11.7%. Together the last three last amounted to 3% of the urban population in 1970. The share of these municipalities would increase up to 39%. 
In Table 9 we have the matrix with the average of spatial transitions in the period 1970-2010 for our sample of 3949 municipalities. Now the probability of a municipality transition from an initial state t0 to t1 is conditioned on the average population of its neighbors, ie on its spatial lag in t0. 
The results show strong evidence that the probability of urban growth of a municipality depends on the urban context around it. Municipalities with more populous neighbors are more likely to grow. For example, a municipality smaller than the average is 99% likely to remain in this size class when its neighbors have urban population lesser than the average. This probability drops to 70% when the neighbors are in the highest class of the population (16 times the average). 
We also can see clearly that the municipalities that are in size classes up to twice the average and have neighbors in the same class are more likely to move down than up. For neighbors above four times the average the opposite occurs, the probability of moving up is higher than moving down. This increases steadily with the increase in the neighbor’s average. 
Table 10 shows some examples of cities that left the lower class population in 1970 towards the higher classes, influenced by its neighbors. These municipalities have benefited from proximity to metropolitan areas (MA). Anandineua in the MA of Belem is one of theses cases. Originally a dormitory town its expressive urban was driven by the lack of housing space in Belem. Serra, in the MA of Victoria had its population growth boosted by a Steel Company installed in 1976. Aparecida de Goiania, in the neighboring MA of Goiania, has become in recent years a major industrial center. Caucaia in Fortaleza MA had a great strengthening in its service sector. Lauro de Freitas, in the MA of Salvador has become one of the most industrialized cities of Bahia. Some of the cities around the MA have consolidated a position of large dormitory towns. As examples we have Ibirite and Ribeirão das Neves in the MA of Belo Horizonte. 
Brazilian urban population has experienced a huge increase from 52 to almost 161 million inhabitants in the period 1970-2010. The average of municipalities more than doubled, from nearly 13,000 in 1970 to 29,000 inhabitants in 2010. There is a predominance of urban agglomerations sparsely populated as only 13-14% of the municipalities have above-average urban population. 
In the regressions to test for Zipfs law, standard significance tests for the OLS coefficients rejected Zipf's Law at any significance level for all years. Our results were sensitive to the method of estimation and to the critical values used to test the significance of the coefficients. For the full sample of municipalities the Pareto coefficient is much smaller than 1 (average 0.74), featuring a polarized and asymmetric urban structure. However, results for those municipalities with population above the average show a less concentrated urban structure and seem to confirm Zipf law (average 1.06). None of the quadratic models confirmed Zipf’s law with standard t critical values. For the spatial models Zipf’s law is confirmed when using Nishiyma’s critical values. The LISA spatial transitions showed that the probability for the pair municipality-spatial lag of remaining in the same size is 96.2% and that in a 40 years interval this probability falls to 88.5%. 
The diagonal elements of the Markov transition matrix were extremely high comparing to the off-diagonal elements indicating high stability and low mobility inter-class over time. The off- diagonal elements that are different from zero are around the diagonal showing that, with rare exceptions, radical changes in population size are uncommon. On the other hand, when the regional conditioning was on the spatial lag, we observed a lower concentration and increased mobility among classes. Spatial Markov transitions show strong evidence that the probability of urban growth of a municipality depends on the urban context around it. Municipalities with more populous neighbors are more likely to grow. A municipality smaller than the average is 99% likely to remain in this size class when its neighbors have urban population lesser than the average. This probability drops to 70% when the neighbors are in the highest class of the population (16 times the average). 
