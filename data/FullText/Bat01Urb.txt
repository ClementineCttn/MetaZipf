George Holmes in his Preface to The Oxford History of Medieval Europe says: Most Europeans live in towns and villages which existed in the lifetime of St. Thomas Aquinas, many of them in the shadow of churches built in the 13th century. That simple physical identity is the mark of a deeper continuity (Holmes, 1992, p. iii). This “deeper continuity” referred to by Holmes has not been central to the theory of cities developed over the past half century. Theorists and commentators have preferred to emphasise urban development as embodying new events such as ‘edge cities’ which re􏰪flect changing lifestyles and new technologies. There has been little attention given to explaining urban development as patterns of settlement which persist and whose contemporary form is the product of a myriad of historical decisions, many of them buried deep in the past. Yet the evidence is clear. Cities and their structures are long-lived affairs, where new locations which appear from nowhere so to speak, are the exception rather than the rule (Hohenberg and Lees, 1985). Where new development does occur, it is largely due to growth into virgin territory and even there, such development is often built on an earlier, more stable and lasting structure of villages and farmsteads. If you look at populations in southern England, everyone still lives within 4 miles of churches which had been planted by the 15th century. In Buffalo, New York, everyone comprising the population in the metropolitan area lives within 3 miles of farmsteads that existed in 1820 (Batty and Howes, 1996). Batten, in his discussion of network cities—cities which have grown together to form specialised polynucleated forms—suggests that: The seeds of such a network economy were sown as far back as the 11th century, when safer trade routes triggered the revival of many medieval cities in Europe (Batten, 1995, p. 319). In fact, quite simple explanations of the growth of cities from initially randomly distributed rural populations to agriculturally based market systems as re􏰪 ected in central place theory, and thence to urban landscapes structured around industrial resources, appear quite adequate. Within such landscapes, restructuring takes place incessantly with new nodes of specialised production and marketing—edge cities in the current jargon (Gar- reau, 1991)—clearly occurring. But in terms of the volume of activity, these nodes are small, with most of the developed urban landscape—as in North America and western Europe—restructuring itself and growing into its older, more established pattern of settlement. Systems like this are path-dependent in that history dictates how they evolve and how they restructure (Arthur, 1988). Decisions which are made early in the history of urban development, often for entirely expedient reasons, determine future decisions through positive feedbacks which in turn reinforce existing forms and functions. Given enough time and the continual effect of such feedback, systems such as cities exhibit a degree of persistence and continuity which is increasingly dif􏰩ficult to break (Batty, 1998). Although new events do deviate from the long-term pattern, at any point in time these are never suf􏰩ficient to set the system on a new trajectory. Cities do rise and fall, but only over long periods where locational advantages change slowly. New settlement patterns do emerge, but these are usually due to growth into previously undeveloped regions—the frontier—or to the gradual 􏰩filling-in of earlier patterns where the ultimate structure which emerges is based upon reinforcing embryonic structures established in earlier times. This is but only one plausible explanation of urban evolution. In this paper, we will tell a story which is consistent with the fact that ‘most’ urban development is rooted in history, bringing to the fore the argument that ‘history matters’. First, we will argue that appropriate aggregate measures of settlement which reveal continuity and persistence in urban development, should be based on variants of rank– size relations associated with city populations. These relations have been shown to be stable over long periods of time and we will present our empirical evidence for such continuities using data from Britain over the past 100 years. We complement this by arguing that weak positive feedback is both necessary and suf􏰩ficient to persistent urban structures and we illustrate this from an aggregate simulation of settlement patterns using the standard growth model based on random processes of proportionate effect. We then introduce a class of spatial models operating at a 􏰩 ne scale in which individual agents of a population move, grow and decline through processes of decision-making incorporating positive feedback. We elaborate the model in various ways,  finally demonstrating how initial patterns of settlement from random distributions, evolve to generate rank– size relations within which cities rise and fall through continual locational change. These models are signi􏰩ficant in that they demonstrate how long-lasting repetition of routine locational processes generates spatial structures which are hard to break, hence resilient. We then show how our earlier empirical and theoretical measures of persistence based on rank– size are also borne out in these model-based simulations. As a consequence of this argument, the structures we generate are inevitably polynucleated in a spatial sense and accord well with more causal observations of the way cities co-operate, fuse and grow together. To proceed, we require some formal de􏰩 nitions appropriate to a simple measure of structure based on city size, Pi, the population in area i. Assuming N cities or areas which contain population and which exhaust the space under consideration, then the simplest measure of structure in the distribution is based on ranking population by size, in descending order where the rank r of the largest population is 1. We de􏰩 ne the population in area i which has rank r as Pir. The rank order thus represents the set of relations between the areas that de􏰩 ne the settlement structure while the degree of persistence can be calculated as some statistic of the difference between rank orders at two points in time, say between t and t+1. Such statistics are de􏰩 ned on differences between P and P where the subscripts t and t+1 have been added to the rank order of each population by area to distinguish between changes in rank and population volumes through time. Differences in ordering also re􏰪flect absolute changes in the population of each area, which implies growth or decline. We calculate the total population at time t as where the summation in (1) is over i or r, for each area i is uniquely associated with a single rank r(t) at time t. In many situations, we are not interested in the absolute change in populations from one time-period to another, but in the relative distribution and thus we de􏰩fine the relative change in population or market share as We can now calculate a series of simple differences between the rank-ordered distribution of population at two different points in time. First, the absolute difference in population shares for any area i is de􏰩fined as and this statistic gives a measure of the percentage shift in population between any two time-periods. Another view of this shift is given by changes in rank order. The average number of ranks that change in a typical area between t and t+1 is given bywhere, rit1 1 is the rank of area i at time t1 1 and rit is the rank of the same area at time t. Note that the sum of each set of ranks is Lastly, the average shift of rank in (4) can be expressed as a percentage shift which is given asIt is possible to have considerable changes in the percentage shift in populations, but no changes in rank, especially if the population is concentrating or dispersing systematically with larger areas growing and smaller ones declining proportionately in market share or vice versa. Zero change in market share of course implies no change in rank from time-period to time-period. To illustrate the degree to which the settlement pattern changes, we will examine the distribution of population in Great Britain (England, Scotland and Wales) at 10-yearly periods from 1901 to 1991 for N = 458 standardised administrative areas which cover the entire land area. During this period which is most of the 20th century, the population grew from nearly 37 million to 54 million, a change of some 46 per cent which occurred mainly in the 􏰩first 50 years. This large change masks the fact that the settlement structure has remained remarkably stable during this period. Because populations are log-normally distributed (for reasons that we will elaborate later), we can show this stabil- ity by plotting the log distribution of population and rank in descending order. We have plotted log against log for t = 1901, 1911, 1921, ... , 1991, in Figure 1, and this shows that the shape of the distribution changes very little from decade to decade. If we correlate every distribution P  against each of the others for the 10 different series, the lowest correlation is between P  and P which is 0.79 (accounting for some 0.62 of the variance). Figure 1 demonstrates remarkable persistence in the settlement system which from more casual evidence at this scale of aggregation, implies that no new major settlements have appeared in Great Britain during the past 100 years. During this period, the largest settlements appear to have fallen in popu- lation with the smallest increasing, thus representing a mild dispersion of populations. We can examine the differences implied in Figure 1 more effectively if we compute the shift statistics given above in equations (3)– (5) and although we can do this for every pair of distributions, we choose simply to concentrate on the differences between 1901 and 1991. In Figure 2, we show the logged rank–size distributions for these years, this time based on the relative population shares p  and p which enable us to remove the absolute growth effects. We also show the distribution of the 1991 population ordered according to the ranks that the same areas i had in 1901—that is, the distribution log  against log. Although there are substantial shifts in the populations of the largest areas, the rank order remains fairly stable at the upper ends of the distributions while there is more change at the lower ends. Over the period, the percentage shift in population has been in the order of 46 per cent, much the same as the rate of growth. In fact, this re􏰪 ects shifts up or down which mean that the absolute percentage dif- ference is half of this, some 23 per cent. This is consistent with the shifts in rank order measured by K and k. The average number of ranks that are changed for each area K is 86 from 458 and this implies a percentage rank shift k of almost 19 per cent. This bears out the fact that during the 20th century at this scale, the settlement pattern has been extremely stable with the pat- tern established by 1901 dominating change in the following 100 years. We have been extremely careful so far to avoid any discussion of the rank–size rule for two reasons. First, as the theory has developed since Zipf (1949) presented the 􏰩 rst general treatment, the events that have been the subject of inquiry have been regarded as ‘distinct’ cities rather than areas which completely and perhaps arbitrarily sub-divide an entire territory. We would argue here that our sub-divisions are not cities and that rank–size and other scaling relations are as appropriate, if not more so, to arbitrary disaggregations of any spatial system. Secondly, most of the work on rank–size has chosen to examine not the entire distribution of city sizes, but the long tail of the city size distribution which can be approximated by a power law (see Carroll, 1982). Nevertheless, it is instructive in this context to examine the relationship to the mainstream as there is much commentary on the persistence of city systems over time which supports the analysis here. The rank– size relation is based on 􏰩 tting a power law to the long tail of distributions such as those shown in Figures 1 and 2. This means that there is an arbitrary cut-off imposed for those areas that do not vary log-linearly with rank, which are the smallest settlements. This is itself problematic as it effectively excludes the origins of urban growth. Nevertheless, the typical relation is based on where, Pr is the population of the area ranked r which is the same as P with the area i and time t subscripts suppressed; K is a constant of proportionality and a is a parameter that controls the change in population between ranks. The strong form of the rank–size rule which was argued by Zipf (1949)—as well as Aubach, Lotka, and others before, see Carroll (1982)—supposes that a = 1 which, from equation (6), means that the 􏰩 first-ranked area is P = K. Then for any rank r The implications of equation (7) seem rather arti􏰩ficial in that the second-ranked city is half the size of the 􏰩 rst, the third one-third the size, the fourth one-quarter and so on down the hierarchy. But the empirical evidence is so strong for many city systems in different parts of the world, and the persistence of the relation through time so clear, that Krugman remarks the regularity is so exact that I 􏰩find it spooky. The picture gets even spookier when you 􏰩find it is not something new (Krugman, 1996, p. 40). There are many problems with this rule. First, some countries have one dominating large city—the so-called primate city— which stretches the long tail at its very top. We have already remarked on the fact that the short tail of such distributions is effectively excluded. The definition of the discrete events that comprise the objects in the distribution—cities—is also in doubt. These are continually changing in size and area, and there has been little sensitivity analysis of how their de􏰩finition affects the parameters of the power law. There seems also to be a tendency for the value of the parameter a in equation (6) to increase slightly through time, implying that city systems are concentrating, with some of the best evidence for primacy and increasing concentration developed for the European system by de Vries (1979) and for the French urban system by Pumain (2000) and others in her group such as Guerin-Pace (1995). To show, however, that the arbitrary sub-division of the urban space demonstrates the persistence of the British urban system, we have 􏰩fitted the scaling relation P = K (or rather its loglinear form) to the data in Figure 1 and this yields the parameter estimates shown in Table 1. From Table 1, it is clear that the slope parameter a t is much bigger than that which would have resulted had the relation been 􏰩tted without the short tail, and that the system is getting less concentrated through time rather than more concentrated. None of this detracts from the scaling that is implicit in the data or the persistence of the system through time. In fact, although we will not present the results for 􏰩tting the truncated distribution because it is not our purpose to justify the rank-size rule in this paper, it is worth noting that the rank–size relation from these data is closer to than the classic form. This provides another tantalising possibility that continues to fuel research into this intriguing relation. Central to change and growth in any system is positive feedback. At a purely phenomenological level, if the rate of growth (or decline) is the same everywhere, the system simply expands (or contracts) uniformly without any change to its internal organisation. This situation is rare. If the rate of growth varies as a function of the size of elements comprising the system, then the largest elements will grow more than proportionately, eventually dominating the system. In city systems, such growth implies that the largest city eventually dominates all the others; in short, it is as though the largest city ‘sucks’ all the growth away from the other cities. This kind of situation is also rare, in that the resulting steady state is simple and unchanging, hardly characteristic of the kind of growth that is implied by the empirical evidence of the last section. Arthur (1988) has examined these types of growth through positive feedback, de􏰩fining three distinct cases. First, where the elements of the system grow in proportion to some natural advantage, even in the presence of noise, this natural advantage reinforces itself through positive feedback. There is no path- dependence in that any deviations from the pattern of natural advantage are eventually removed. Arthur’s (1988) second case is quite the opposite in that growth is based on chance rather than necessity. Growth occurs in proportion to what is already there but in the presence of noise, and although this process settles to a steady state, noise dictates entirely what this state will be. The third case is one where growth depends both on natural advantage and on economies of scale in that as a city grows its future growth depends on what is already there. If one region gets ahead, then this growth is reinforced and eventually, the region or city will dominate. This is akin to the situation where all growth is attracted towards the biggest city as the rate of growth is largely a function of the size of each city. In the last two cases, the ultimate state of the system depends on the way random events or noise dictate its historical evolution, but it is the second case that appears most realistic. From a random distribution, some pattern ultimately emerges which is not based on simply one city asserting itself. However, Arthur does not deal with cases where the growth rate itself is random, for his model is based on the randomness of location. Thus a fourth, more persuasive, case might be considered where growth is in proportion to size but the rate of growth is random, thus ensuring that there will be no ultimate unchanging steady state. To demonstrate this, we de􏰩fine population in area i and time t as Pit where for the moment we suppress rank r. Then the change in population between any two time-periods t and t1 1 is de􏰩fined as with the rate. We are now in a position to formalise the process of growth. First, we state that the rate of growth is random, de􏰩fined as where,  is the random rate of growth associated with area i from time t to t+1. Using an appropriate form for equation (8) and integrating from the initial distribution P to the current P givesThe model thus becomeswhere the change from one time-period to the next isThe process implied by equations (10) and (11) is one of proportionate random growth where the increments of growth are distributed lognormally. From any initial distribution Pi0 which may in itself be random (or uniform), the limit of the process is lognormal. If the growth rates were all the same— that is, there were no randomness and it—then there would be no redistribution of activity from the initial distribution, that is Randomness is thus essential in generating a distribution that is continually changing. To show that this model generates distributions that are persistent and similar to those which have been widely observed for city systems (as in Figures 1 and 2), we have run the model in equations (10) and (11) for many iterations, with parameters that loosely approximate those of the population of Great Britain between 1901 and 1991. We have set the number of areas as N = 458, the total time of the simulation as T = 1000, and we have begun the process with a uniform distribution P = 1/N. We have run the model for 1000 time-periods which provides a ‘rough’ comparator with the settlement history of Britain from 1000 to 2000. As with the empirical data which we illustrated in Figures 1 and 2, we show the rank–size relations predicted from the proportionate growth model in Figure 3 for P and P against their respective ranks r and r. We also show the distribution P against the previous rank r which is measure of the displacement of ranks over 100 time-periods. During this period, the shift in population K is about 22 per cent which is about half the actual shift in the real data for Great Britain. The average number of ranks which are altered during this time is K= 34 which is about 7 per cent of the total number N. These 􏰩figures are less than half those associated with the real change and this simply implies that we need to redimension the time over which the process operates to bring the simulation nearer the observed changes for Great Britain. In fact, it is not the actual values that are important here but the con􏰩figurational nature of the simulated relations. The forms of the rank–size relations generated in this way are extremely close to those observed in Figure 2 for Great Britain. Lognormal distributions do emerge from the initial uniform distribution of settlement as expected and the shift in ranks over 100 time-periods (t = 900 and t = 1000) has a similar form to that shown in Figure 2. In fact, comparison of Figures 2 and 3 which are dimensioned on the same axes, imply that the observed and simulated distributions are from the same class. To impress this similarity even further, we have fi􏰩tted straight lines to the simulated rank–size relations in Figure 3. The initial distribution here at t = 1 is uniform and the variation with respect to rank is thus arbitrary. For comparison, however, we have included this in the estimation which we show in Table 2. As the total populations are not comparable in any way with the observed results, then we have regressed the market-share equivalents p and p  against their respective ranks. The results are given in Table 2. It is worth noting how similar these results are to those for Great Britain. Although the slope increases slightly as the simulation continues between t = 900 and t = 1000, implying a slight increase in concentration, the size of the slope and the correlations are consistent with those in Table 1 for the 1901 and 1991 British regressions. This, combined with the visual consistency between Figures 2 and 3, implies that the law of proportionate effect which is based on random growth appears extremely appropriate for explaining the persistence of settlement structure and the way cities or areas can slowly change their relationships to one another through temporal growth. In fact, this model was 􏰩first suggested by Gibrat (1931). Surprisingly, although widely referenced in the rank–size literature, it has not been used very much. A variant due to Simon (1955) has been recently popularised by Krugman (1998), and there was some considerable discussion in the literature of the Gibrat–Simon model in the 1970s (see Parr, 1976). More recently, there has been a reawakening of interest in Zipf’s law and proportionate effect in theoretical physics (see Marsili and Zhang, 1998). But the single most important issue here is the fact that settlement systems seem to persist over long periods with few changes in the rank of areas and that such persistence is due to random but proportionate growth, negating any economies of scale that might be associated with larger cities. This means that over very long time-spans, this process can change the rank and size of cities dramatically. Thus the process does provide opportunities for radical change in structure while at the same time implying the persistence of well-established patterns. To demonstrate the argument that urban systems evolve spatially through the incessant application of weak positive feedback over long periods of time, we require models which meet three criteria. First, the models must treat activities at as disaggregate a scale as possible, ideally at the individual scale so that the greatest possible micro-diversity occurs consistent with random growth. Secondly, growth (or decline) must occur through the routine action of many decisions slowly building on one another over long periods of time; while, thirdly, to evolve city systems where different clusters of cities are highly interdependent—which is the modern mark of polynucleation or network cities— such models must simulate movement between individuals and the resources they consume at the micro-level. Agent-based models of this kind have only recently made their appearance in the social sciences, largely due to advances in computation and data which enable individual objects or events to be simulated explicitly and, to date, most applications have been to theoretical situations (Epstein and Axtell, 1996). Here we will develop a series of such models which re􏰪 ect a plausible way of unpacking the processes that lead to the kinds of persistence and polynucleation representative of the changes in settlement patterns that we measured earlier in an empirically and theoretically aggregate manner using rank– size relations. Once we demonstrate how these models work, and what they are able to produce, we will also show that these models are able to generate persistent polynucleated structures with similar rank–size relations. Agents A are now de__ ned by the subscript i and resources R by the subscript k. At the most basic level, agents ‘move’ within the system from their origins given by co-ordinates Xi, Yi in search of resources (to keep them alive!) which are located at destinations Xk, Yk. The location of agents as they move to capture resources is signi􏰩 cant in that their location at time t is given by A while resources do not move and hence are fixed at R(Xk, Yk). The resolution at which the spatial system is represented, and at which movement takes place, is given by a series of 􏰩fine-scale cells de􏰩 ned by distances D x and D y, and the movement of any agent i from time t to t 1 1 is always computed in terms of their co-ordinates as Note that the changes in co-ordinates and as well as the small random errors in movement  and are speci􏰩fic to agent i at time t. The computational mechanics required to simulate such movement are not central to this paper, but their details can be found elsewhere if required (see Batty and Jiang, 2000). In essence, the structure we are suggesting is another way of representing the movement of individuals from, say, home to work, or any other kind of trip-making decision, and the basic model we will begin with—which is at the basis of all our subsequent models— can be conceived in these terms. Origins and destinations do not vary and the dynamics that are implicit in this basic structure are those of routine movement. However, because we are simulating an interaction system between cities that evolves through time, we assume that when new agents enter the system (through migration or growth), then they need to ‘learn’ where the resources are located. They do this by responding to the signals that have been left in the system by preceding or current agents. These signals form a landscape of routes or tracks which we de􏰩 ne as a continuous function W (x ,y). Now, the movement dynamics for any agent can be separated into two phases: 􏰩first, in terms of responding to where resources are available, which involves learning in some way about their location; and, secondly, in terms of their return to origins once resources have been located, so that the resources might be consumed in some way. The learning phase of this dynamic proceeds by agents moving in direct response to the local gradient of the landscape which records the local density of interaction already established by the behaviour of previous agents. Each agent works out their local gradient which is given as and then chooses the direction in which to move in terms of changes to their current co-ordinates given by D and D. They do this by choosing the local maximum of equa- tion (13) which ensures that an agent will always move in the direction where interac- tion is strongest which in turn is in a direc- tion where previous agents have sought out resources. Once an agent 􏰩finds a resource location at R, then it ‘engages’ with these resources in some way and thence returns to its origin using a different procedure. Agents ‘remember’ where they are located at A(Xi, Yi) and thus 􏰩 x their changes in direction D xi and D yi as function of the origin location, that is However, once the resources have been discovered, the agent also ‘remembers’ this location. As the agent returns to the origin, it ‘lays a trail’ or updates the landscape function to re􏰪flect this new knowledge by where, the constant / is a ‘pulse’ re􏰪 ecting the increased interactivity of the landscape at this point, thus adding to the attraction of that location as a signal for future movement. These models are increasingly popular for simulating movement where learning is a prerequisite to establishing stable structures which emerge from no knowledge of the landscape whatsoever. They have been developed for simulating animal populations such as ‘ants’ (Resnick, 1994), but are 􏰩finding wide use in modelling movement systems which are too complicated to represent in formal frameworks such as telecommunications traf􏰩fic, travelling salesmen problems and the like (Bonabeau et al., 1999). They are also being employed in the micro-dynamics of traf􏰩fic simulation, crystal growth and related problems in physics where they are referred to as ‘active walker models’ (Lam and Pochy, 1993). They are being used to model actual behaviour based on walking in cities and buildings where they are forming a new basis for pedestrian modelling (Helbing et al., 2001). In this context, they are essential in building up spatial structures, from the beginning of time so to speak, where the original landscape is uniform with no settlement, something which is implicit in the long time-scales adopted by the approach presented in this paper. In the rest of this section, we will simply illustrate the working of the model, noting that the local dynamics of movement simulated here will eventually be embedded in broader dynamics where origin and destination activity re􏰪 ect growth of the system. Our first example is based on one origin and a regular small compact cluster of destinations with all our examples being simulated on a 200 x 200 lattice. We have located 1000 walkers at the centre of this lattice and located a square area of resources some 80 units distant to the north-east of the origin. We can display three key patterns from this model: 􏰩first, the actual position of each of the agents in the space; secondly, all the paths that the agents have taken so far; and the landscape function (which represents cumulative laying down of permanent tracks) at any time t. The 1000 walkers 􏰩first move out from the origin in random direction because the landscape function w (xi, yi) is uniform everywhere; no resources have yet been found and thus the pattern of movement computed from equation (12) is random. We show this initial situation in the top two maps in Figure 4 where we omit the landscape function as it is uniform. As agents locate the area of resources through this random— Brownian—motion, they then return to the origin, laying tracks—which, in this case of one origin and one destination, is a straight line between the centre of the space and the square patch of resources. After 200 time- periods, the agents have covered the entire space and, although the landscape function is now quite distinct, there are still many agents in the space who have not yet discovered the resources. By time t = 2000, the agents within space show a de􏰩finite tendency to follow the tracks which now dominate both the pattern of all tracks to date as well as the landscape function. Figure 4 represents a clear pattern of spatial learning and, in this case, the simplest of networks where there is no competition between nodes. We now relax the problem by clustering agents in 10 origin locations themselves randomly located in the space, and 13 destination locations. The 1000 agents are uniformly but randomly assigned to origins. Destinations, as before, do not have volume but simply area. We show these data in the top row of Figure 5 which also illustrates the evolution of the structure over 5000 time-periods. In this simulation, because the agents have greater opportunities for discovering resources—the densities are higher and the locations more varied—by t =50, tracks are being marked out on the landscape even though the entire space has not yet been explored. By t=500, the nodal structure— essentially the main links between origins and destinations—is being stamped out in the landscape and, by t= 5000, the structure is extremely clear with most of the agents moving on the main links in the system. What is interesting about these simulations is how the transport structure becomes structured through random discovery with the densest links in the central part of the space and links between any origin and destination re􏰪flecting distance in a simple way. In fact, competition between nodes is clearly evident in this structure with nodes and links that get ahead faster in the process clearly retaining this superiority. The pattern which is marked out by this system is polynucleated of course, but is largely fashioned by the assumptions made about 􏰩fixed origins and destinations. We should also note that once an agent 􏰩finds a resource, the resource is consumed with a given probability ensuring that agents are able to exercise choice in their acquisition. Our last example relaxes the effect of prior structure. In Figure 6, we show the simulation where the original distribution of agents is entirely random but where there are a small 􏰩fixed number of resource locations which dominate the structure. The structure which eventually emerges by t = 5000, represents the simplest star-shaped patterns of interaction around resources. In fact, what happens in this simulation is that the tracks gradually begin to reduce in number as tracks compete against each other. For example, as a track in the landscape begins to build up, it attracts walkers from other tracks and thus nearby tracks which run almost parallel begin to compete for walkers. This process is entirely conditioned by the degree of randomness in path selection as re􏰪ected in equations (12) and (14). Although this is not the clearest of examples, these effects do reveal that, even at this level in terms of these models, ‘history matters’ in that if one location gets ahead, it tends to keep this advantage through positive feedback. The structure thus persists but it is held in a precarious balance in that, over the much longer term, such feedbacks can gradually decay in their impact. So far, our origins and destinations have been 􏰩fixed, there has been no growth, and all we have shown is the way positive feedback enables interactions to be established between these 􏰩xed activities. We can now relax the model and embed the movement dynamics within a wider process of urban dynamics which enables new agents and new resources to be located while retaining the learning capabilities of the interaction behaviour. In our models, we will assume a uniform growth process, locating one new agent at each time-period, introducing two possibilities: fi􏰩rst, we will simply locate new agents keeping the initial distribution of resources 􏰩fixed; secondly, we will introduce both new agents and new resources which the agents generate, but again keeping the growth process uniform. We could generate changes to the location of agents through internal movement of these locations in response to how the system is developing—in much the same way, for example, as agricultural populations were attracted to the growing cities during the industrial revolution. However, we prefer here to generate new agents by locating them with respect to some measured structure of the system, based on some potential P(x, y, t) which re􏰪flects the spatial distribution of the agents so far and which, like the landscape function introduced above, responds to changes in new agent location as a positive feedback. We de􏰩 ne this potential function as where, the diffusion term and its coef􏰩ficient h represent the gradual spreading of the potential through time; the term o (x, y, t) represents the additive effect on the potential of one agent locating in each time-period; and « (x, y, t) is an error term that enables a degree of diversity to be introduced in the process. Note that, although potential is computed for every point or cell in the space at each time, only one location is associated with a new agent o (x, y, t). The extent to which potential is reinforced through the continued application of equation (16), depends on the balance of forces within the equation. In these simulations, the effect of the error term is substantial and this is dimensioned so that current local potential is most important but that distant places from the current highest levels of potential can always grow through such errors being reinforced. Once potential is computed in this way, the location of a new agent i at co-ordinates, is based on identifying the maximum value of equation (16). That is, and thence the variable o (x, y, t) is set as a unit increment for the location Xi,Yi which drives the function in equation (16). In Figure 7, we show the evolution of a spatial system to t = 2000 using this model. We randomly locate some 6 initial resource locations but, from then on, we use equations (16) and (17) to locate the agent population. From this simulation, we see that several clusters of population grow up, not adjacent by any means to the initial resource locations. Although we do not show this, these clusters do not grow uniformly—that is, they do not emerge together. There is a complex dynamics initiated by this process which is re􏰪flected in the interaction maps as well as the polynucleations which result. The potential from equation (16) is also shown in Figure 7 which reveals a diverse picture of change in that there are locations with comparatively high potential at time t = 2000 which have not yet had a chance to establish their claim for the location of new agent populations. It is the micro-diversity of this potential surface that ensures competition between clusters of settlement within the system. We can now describe a much fuller version of this model where we add the location of new resources through time. Assuming that our agents are populations and our resources employment activities, we argue that one new employment activity generates three units of population and that the units of employment activity are industrial and service in their orientation. This is a long-standing distinction in urban systems and all it means is that industrial activities are more likely to be generated from other industrial activities, while service activities are more orientated to populations. Here, this implies that the initial resource locations tend to generate industrial resources more than population or services. These relationships are casually built into the model in terms of the weighting of potential for new agents and resources. The potential function in equation (16) above can now be extended and generalised with respect to the new activities and their relationships in the following way: similar to the single potential for agents or populations in equation (16) except that the sum of objects o i(x, y, t) over i is meant to re􏰪ect a sum of both new agents and new resources. The parameters of diffusion and the error terms are of course speci􏰩 c to the potential involved. Finally, we should note that the initial levels of potential are ran- domly distributed. New activities—popu- lation P, industry I, and services S—are then located in cells of maximum potential from equation (18) according to the previous logic in equation (17). We have run this model up to t = 2000, and we show these simulations in Figure 8. In this model, there are many outputs that we can examine, but here we will concentrate 􏰩rst on the patterns of population that are produced. It is quite clear that these patterns do not bear much resemblance to the initial distribution of resources. Moreover, it is also clear that new spatial clusters emerge throughout the process, thus ensuring that no particular cluster becomes singly dominant. This is, of course, the typical signature of a polynucleated urban landscape. In Figure 8, we also show the pattern of transport routes which indicates how the earlier clusters have more intensive interaction than the later clusters. In fact, as new resources begin to dominate the initial distribution, the initial pattern of resources is soon wiped out. As new resources depend on new populations and vice versa, the structures that emerge are in fact highly consistent with those that are seen in real city systems such as in the north eastern seaboard of the US, in the Randstad or in the north-west of England. We also show here the potential for the service resources after 100 time-periods of the simulation, and thence after 2000. From an initial pattern which is highly correlated with the early population clusters, the potential gradually diffuses. In this paper, we are not going to dwell on the mechanics of 􏰩 tting hypothetical simulation models such as these. Suf􏰩fice it to say that even with the very small number of parameters that these models use, there are still considerable variations in the outputs that can be generated. However, in the case of the potentials critical to the model’s growth dynamics, it is likely that the errors rates need to be higher than those we have used to re􏰪 ect greater micro-diversity. However, even with those used, the spatial structures which emerge clearly represent strong tendencies towards polynucleation. It is a straightforward matter to compute rank– size relations from the urban development patterns produced by the full model as shown in Figure 8. However, the model only produces uniform densities in each cell, and as the space 􏰩fills up, rank– size relations will inevitably 􏰪flatten in their long tails. What we have done is to take the scanned patterns captured on 400 x 400 grids and to aggregate these to 20 x 20 grids from which counts of the occupied cells are made. We have excluded all those cells which have zero occupancy. Although the total possible fi􏰩lled cells is 400 (which compares with the previous empirical data for Great Britain and the aggregate theoretical model), only a subset of these have activity which rises from N=88 at t=100 to N= 282 at t= 2000. The rank–size relations are shown in Figure 9. These are much less smooth than the previous empirical and theoretical aggregates which is due to the somewhat coarse nature of the spatial simulations. However, they reveal clear evidence of scaling, similar to that shown earlier in Figures 1–3. The relations shown in Figure 9 are based on the 7 patterns shown in Figure 8 for t=100, 200, 500, 900, 1000, 1900 and 2000. The scaling relations appear similar through time, notwithstanding the gradual 􏰪flattening of these curves. In fact, relations are near pure rank–size to begin with but, as the simulation proceeds, they become progressively like those observed in reality (Figures 1 and 2). To gauge this, we have fi􏰩tted the rank–size equation from (6) to the data at these time-periods and Table 3 presents these results. Strictly speaking, we should only 􏰩t these relations to the long tail of the distributions in Figure 9, but it is still clear that the slopes are higher than those of the empirical and theoretical aggregate models. However, although the slope increases slightly at 􏰩first, it then decreases through time, without any signi􏰩 cance in terms of increasing or decreasing the concentration of settlement clusters. To test the changes between time-periods—a better test of the stability of the system—we have computed the percentage shifts in population shares given by C  and the shifts in rank order K  and k. We have computed these between t = 1900 and t = 2000, although this period is probably too small. This is thus only indicative of the sorts of shift that are taking place in this model as well as in real cities and in the theoretically aggregate model. The percentage shift C  is of the order of 8 per cent which is much smaller than that given by the British data and the aggregate model. This is re􏰪flected too in the average rank shift K  which is 33 out of 282, with a percentage rank shift k  of 12 per cent. We have plotted the t = 1900 and t = 2000 logged distributions of p and p against their log of rank in Figure 10 where we also show log(p) against log(r) to show the shifts in rank. In fact, although the shift in rank is similar to that for the aggregate model given previously, the nature of the shift is different with less numbers of aggregated cells changing much more than in the previous analyses. Nevertheless, what this analysis does show is that the spatial disaggregate model produces rank– size relations which are con- sistent with our earlier examples and that, with some redimensioning of the temporal process over which these changes are computed, both models in this paper are producing similar results which bear out the empirical analysis. Plausible though the models in this paper might appear, they are only one variety from several new approaches which appear promising in the analysis of the evolving spatial structure of city systems. The notion that cities exist at a critical threshold which they maintain through growth and redistribution is also one which is consistent with persistent urban structures. Work along these lines has shown that cities can grow and change radically in terms of their densities but, at the same time, remain within strong limits (Bak, 1996). Batty and Xie (1999) explain how cities continually readjust their form to a supercritical level, fi􏰩lling their geometric space in the same way they have done for decades. For cities to make the transition to other spatial forms, there have to be radical changes in technology and/or behaviour and it would appear that, in contemporary times, this might only come if people were radically to change their patterns of movement. We have not explored the extent to which these models keep within critical limits, although casual observation of the forms that they generate suggest that they do. At one level, the evidence for persistent urban structures that we have presented here, and the kinds of polynucleated urban land- scapes that emerge over centuries and mil- lennia, are obvious. It is easier to build and replace on what has gone before than to strike out anew. In this very de􏰩 nite sense, ‘history matters’. But, at another level, this kind of persistence is harder to explain and simulate than new activities. Weak positive feedbacks are more dif􏰩 cult to pin down than the stronger forces that continually impress economies of scale. In fact, persistence may be due more to interactions in the economy than to building on and around what already exists, in that individuals can adjust their interaction patterns quite dramatically without changing the spatial structures in which those patterns exist. These are ideas for the future but all the elements for their develop- ment are contained in the approach which we have chosen to pursue here. It could also be remarked that the approach here is too physicalist—although once very long-term dynamics are invoked, physical competition between cities provides an implicit economic dynamics which generates plausible spatial structures. What these dynamics also show is that polynucleated spatial structures are more likely to be the rule rather than the exception. Moreover, the edge city phenomenon is but one variety of node in a sea of development which is continually restructuring and changing. Finally, this paper has presented a somewhat unusual exercise in analytical mod- elling. In fact, we have presented two different types of model—one aggregate based on random proportionate growth where the spatial characteristics of the system are completely absent, and the second a spatially disaggregate version which we argue contains the same kind of weak growth mecha- nisms that characterise the aggregate model. Both these models generate persistent struc- tures which are similar to those found in real city systems, while the spatial model sug- gests that the usual form of such growth is likely to be polynucleated. There is much work to do on this approach in that our mix of the empirical and theoretical at different scales and levels enables us to capture the kind of diversity that is characteristic of cit- ies and that we have found hard to deal with hitherto. In future work, we will take these ideas further, linking interaction to location through explicit feedbacks and dimensioning the growth levels and time-paths of our theoretical models more appropriately than we have been able to do here. 