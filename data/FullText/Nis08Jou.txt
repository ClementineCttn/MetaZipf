The so-called rank-size rule has often been observed in a large number of studies on city size data. Let Si be the population of cities in a country, and S  be its order statistics satisfying then we often observe that 
where This relationship is referred to as the rank-size rule when the coefficient of log (rank), and it has attracted considerable attention from researchers thus far. 
The rank-size rule itself is a simple description of city size data. It does not indicate how and why it occurs. However, it is well known at least that the rank-size rule follows approximately when Zipf’s law holds. Zipf’s law, which was proposed in the pioneering works on city size distribution by Auerbach (1913) and Zipf (1949), is as follows. Let S denote a random variable representing city size measured by its population, then for a large x, 
for some or a Pareto distribution with unit exponent.
Some studies discussed the rank-size rule in association with economic development. Berry (1961) examined the city size distribution pattern for 37 countries in order to find a clear relationship with the level of economic development. Parr (1985) also examined the same relationship in 12 countries over a period of 70 years, whereas Gabaix (1999) and Duranton (2006) constructed city growth models that lead to Zipf’s law. Thus, these studies have led to microfoundations for the establishment of Zipf’s law as a result of economic development, and hence, to foundations for the rank-size rule. Moreover, Eaton and Eckstein (1997), in their sophisticated analysis, showed that the size distribution of cities has been highly stable over time in France and Japan, and offered a theoretical underpinning for the stability of city size distribution. Hence, their results indicate that the rank-size rule, once established, would hold as a long-run relationship. 
When we turn to the empirical side, regarding (1) as a regression model, many researchers have estimated and by the ordinary least squares (OLS) method and implemented the t test for the rank-size rule. One of the most important papers in this field is perhaps that of Rosen and Resnick (1980) who examined 44 countries. The mean of the estimates for the reciprocal of the coefficient of log (rank) (i.e.,) is −1.14, and the estimates are smaller than −1 in 32 countries. They further investigated if the Pareto assumption is acceptable by applying the t test to additional nonlinear terms. Soo (2005) also conducted an international comparison by using the updated observations of 73 countries for cities and 26 countries for urban agglomerations and by employing OLS and the Hill’s (1975) estimators, where t tests based on OLS estimation reject the null for the majority of countries (53 out of 73 countries for cities, and 18 out of 26 countries for agglomerations). Mills and Hamilton (1989, chapter 4) also rejected the null for the U.S. 1980 data by performing the t test in the regression of.
When we evaluate these empirical studies, one of the important points to be considered is what kind of distribution we assume. This is because the statistical properties of the estimated coefficients and the t statistic crucially depend on the assumed distribution. From the above discussions, it would be very natural to assume the Pareto distribution when considering the rank-size rule. From the purely statistical aspects, the estimation of the tail exponent for heavy-tail distributions has been a topic of interest for researchers since the 1970s. The Pareto distribution is one of the simplest distributions with a fat tail. In the case when the Pareto assumption is true, the parameter(s) can be estimated efficiently by means of the maximum-likelihood principle. Since the pioneering work by Hill (1970), statisticians have proposed estimators for such semiparametric models departing from the Pareto distribution, where they parameterize only partly in the tail. See Csorgo and Viharos (1980) for a detailed overview of the various methods used in this field. 
Whereas there is no doubt that these newer statistical methods are interesting and important, they may not be easy to implement from the practical point of view. This is because these semiparametric estimators typically involves a user-determined nuisance parameter whose feasible optimal choice is unknown, although it can substantially affects the results. Thus simpler methods by OLS and the t test have attracted attention of most of the empirical researchers. However, it cannot be stated that the statistical properties of these methods have been fully examined (see e.g., Gabaix and Ibragimov, 2006, for the asymptotic normality and an asymptotic expansion of the OLS estimator for the rank-size rule regression). Therefore, it would also be worthwhile to uncover them at least in order to evaluate the previous studies that used the methods such as those used in Rosen and Resnick (1980), Mills and Hamilton (1989) and Soo (2005). One can easily expect that standard classical theory does not apply at all due to the construction of the dependent variable in (1). 
The following example indicates the difficulty of applying the standard arguments regarding OLS to the rank-size rule regression. Figure 1 describes the relationship between log S and log I with respect to Japanese cities for the years 1980 and 2000. These data are on the Japanese Urban Employment Areas (UEAs) and are available at the website of the Center for Spatial Information Science at the University of Tokyo. Table 1 describes the estimation results of (1) by OLS. In both years, the estimated value of 􏲪1 is close to −1 and it seems that the rank-size rule holds quite well. However, the t statistic associated with the rank-size rule null is highly different in these two years. In fact, based on the standard t test, the rank-size rule is not rejected for 2000 even under the significance level of 10 percent, whereas it is rejected for 1980 under the significance level of 5 percent. This instability of results in hypothesis testing induces us to investigate the statistical properties of OLS and the associated t statistic under the Pareto distribution. 
This paper complements the literature in the following three aspects. First, we derive the accurate and approximate moments of the OLS estimator. In particular, we show the expressions of bias and variance of the estimators, whose leading terms are consistent with the results in Gabaix and Ibragimov (2006). We assume are independently and identically distributed (i.i.d.) and that Si has a Pareto distribution. Under these assumptions, we show that 
does not strictly hold for in small samples, but it holds only approximately for large n and i. Further, the approximation is worse for smaller i. This introduces a bias of the OLS estimator for. We then obtain the accurate and approximate expressions of the bias and variance of the OLS estimator. Secondly, we show that the t statistic for the rank-size rule null — that the coefficient of log (rank) is equal to minus one  —  does not have a t distribution unlike standard classical linear regression theory. This is because S  is in fact autocorrelated and heteroskedastic. We even proved that asymptotically, which means that the greater the sample size (or the number of cities in a country), the larger its t value tends to be. Therefore, even if the null of the rank-size rule is correct for a country, it tends to be easily rejected when the country is large. Hence, using the Monte Carlo method, we develop the critical regions for the rank-size rule null and for the non-Pareto behavior when we use t statistics. Indeed, applying these corrected critical regions for the t statistic, we find that the rank-size rule holds for more countries than observed in the previous studies such as Rosen and Resnick (1980) and Soo (2005). (In fact, the rank-size rule null is not rejected for both years in the above example described in Table 1.) Third, based on the findings of the first point, we propose a simple but more efficient estimator. It is a trimmed least squares regression. The idea underlying this is that we can expect to improve the statistical properties of the estimator by excluding some observations with smaller i. 
In the following section, we show the accurate and approximate expressions for and and then derive the bias and variance of the OLS estimator for (1). Subsequently, we present the Monte Carlo results on the distribution of the t value for the estimator that never follows the t distribution, indicating that the usual t test is not applicable to test the null of. In Section 3, we propose more efficient estimators, whereas in Section 4, we reexamine the results obtained by OLS in Soo (2005) for urban agglomerations. Section 5 concludes the paper. 
Let and denote the cumulative distribution function and density function of a random variable X. Assume that city size observations are i.i.d. from the distribution function 
Or the density
Before providing a justification for (1), we prove the following Lemma on some moments of log S, used to evaluate the bias and variance of the OLS estimator. 
LEMMA 1: When is a random sample from (3), and are the order statistics satisfying, we have 
Proof : See Appendix A.
From Lemma 1(a), we obtain the following proposition: 
PROPOSITION 1:
Proof : See Appendix B. 
Proposition 1 implies that (2) approximately holds when n and i are large with and. In keeping with the literature on Zipf’s law, this provides a justification for estimating (1). 
Next, we focus on the bias and variance of the OLS estimator for (1). Let be the OLS estimator for in (1). Then, we have 
where and hereafter we omit the summation range if not ambiguous. The following proposition provides the accurate and approximate expressions for the bias and variance of the OLS estimator. 
PROPOSITION 2: 
Proof : See Appendix C. 
Cn and Dn are constants that depend only on n. If Cn is equal to zero, OLS gives an unbiased estimator for the coefficient of rank. However, we note that the leading term of Cn is negative, which implies that the OLS estimator tends to have a downward bias as found in the Monte Carlo study of Gabaix and Ioannides (2004). Moreover, the source of the bias is the approximation error shown in Proposition 1 in the sense that for log, we have in a small sample (when n is small), which is a crucial violation of the standard assumptions of OLS theory. Cn and Dn are shown in Figures 2 and 3, respectively, and Table 2 tabulates them for sample sizes of n = 50, 100, 200, 500. We observe that both of them approach zero as n increases. We also remark that the variance is approximately equal to, which is, of course, consistent with Proposition 2(b). 
In view of Proposition 2(a) or (C.2), we can easily construct an unbiased estimator for the coefficient of rank, namely 
where the multiplicative constant depends only on n, independent of (nuisance) parameters. Because the constant is smaller than one in absolute value, this estimator not only eliminates the bias, but also reduces the variance. 
We begin by reproducing the theory of the t test from textbooks. We carry out the t test in testing the significance of coefficients of linear regression models. Suppose that we would like to test the null hypothesis of in the following regression model with a nonstochastic regressor zi, 
where and are independent. Let (a, b) be the OLS estimator of
and
we construct the corresponding t statistic 
where is the (2,2) element of V. Then tb has the t distribution with degree of freedom under the null. If tb is larger than a certain, say 97.5 percent, quantile of the t distribution with degree of freedom in absolute value, we reject the null of at the significance level of 5 percent. 
However, if the assumptions on the distribution of y do not hold, tb does not have the t distribution, resulting in size distortions. In the present case, the t statistic in fact does not have the t distribution because log S, the dependent variables, are neither normally distributed nor independent (they are heteroskedastic and autocorrelated by construction). Using Monte Carlo simulation, we obtained the distribution of the t statistic for, the coefficient of log-rank, in regression (1) under the null of. Figure 4 shows the histogram from 100,000 replications when. The mean, variance, skewness and kurtosis are, respectively, −2.512, 171.0, 0.423, and 4.012 for this distribution. Figure 5 compares the true distributions of t value for the cases of and with the t distribution with the degree of freedom 198. Thus, it is clear that these true distributions are far from the t distribution, whose mean, variance, skewness and kurtosis are, respectively, 0, 1.010, 0, and 3.030. Table 3 shows the critical regions of a two-sided test for different sizes calculated from the simulation that should be used in testing instead of the quantiles of the t distribution. It becomes immediately clear that there exists a severe size distortion if we apply the standard t test to because its critical region in the case of a 5 percent size, for example, is set to be around Moreover, it can be shown that for t 
where denotes the (2,2) element of, which is equal to
This indicates that the t value explodes asymptotically even under the null of the true parameter value. It can also be shown that the t statistic becomes larger in magnitude as the sample size increases. (For these points, see Nishiyama and Osada (2004), which is the former version of this paper.) This phenomenon is caused by the fact that the standard error of the regression tends to zero as (the proof can be obtained from the authors upon request). 
In works such as Rosen and Resnick (1980) and Soo (2005), the following two equations are estimated: 
Equation (5) seeks to test the rank-size rule null, that is, whether. We note that (5) is a reversed regression of (1), and typically, the results from the two regression are different. However, Gabaix and Ibragimov (2006) proved that they are equivalent in the first order. In order to test for non-Pareto behavior, it is common to include the powers of the explanatory variable and to check whether or not the coefficients are zero. Hence, (6) seeks to examine the Pareto distribution null, that is, whether. Rosen and Resnick (1980) and Soo (2005) examined these null hypotheses (whether and whether) by the t tests, and they were mostly rejected because of “large” t values. However, we need to be careful when evaluating the results because we would again face the phenomena that the null of the rank-size rule and Paretoness are likely to be rejected because of the irregular behavior of t statistics even if both hypotheses are true. This is also pointed out in Gabaix and Ioannides (2004) by a simulation. In Table 4, we provide the critical regions of a two-sided test for different sizes calculated from the simulation in order to test the significance of the coefficients in (5) and (6). 
The table shows that also in these regression models, the application of the usual t test provides very large t values, leading to inappropriate conclusions. 
We also remark that we can test the null of the rank-size rule by using the asymptotic normality result proved in e.g., Gabaix and Ibragimov (2006) instead of using t statistics with their corrected critical regions. They showed that, when (5) is estimated, follows the standard normal distribution asymptotically. In contrast, we provide the exact distribution of t statistics by simulation. Hence, the test of Gabaix and Ibragimov (2006) and our test should be used complementarily because the former may not work well when the sample size is small whereas the latter may accompany simulation errors. Moreover, in view that is the linear combination of i.i.d. standard exponential random variables (See (A.1) and (A.2)), which is highly skewed, approximation by normal distribution may not be very accurate in small samples. On the other hand, our method is based on the exact distribution of t statistics, and thus, we may expect a better performance of our method in small samples. For the Paretoness test based on in (6), we still do not have any validated statistical theory. 
Previous section provided a method to test the rank-size rule. Consider a case in which the rank-size rule is not rejected. Then, what we expect next is to obtain a point estimate of in (1). Here, we propose a more efficient estimator than. It is a trimmed least squares regression. The logic underlying this method is as follows. Observing that is larger for smaller i, and also that the approximation (1) is worse for smaller i in view of Proposition 1, we can expect to improve the statistical properties of the estimator by excluding some observations with smaller i, or larger observations. 
Proposition 1, Lemma 1(a) and standard least squares theory imply that the source of the bias of least squares estimators is the approximation error of, and it is larger for smaller i. We then conjecture that the bias can be reduced by excluding observations with smaller i. Further, Lemma 1(b) implies that the variance of least squares estimators could decrease if we trim observations with smaller i, although there is a trade-off between efficiency gain by the exclusion of larger variance data points and efficiency loss due to the reduced sample size. Furthermore, in view of Proposition 1, the approximation (1) is less accurate for smaller i. Hence, removing samples with small i will reduce the bias of the estimator. Thus, removing large cities from samples may seem to be less desirable intuitively, it in fact provides a more efficient point estimate. Let be OLS estimators from the subsample of where the larger k observations are excluded. Then, similarly to Proposition 2, we have 
And
Let its (2,2) element be 
C and D constitute the mean squared error, and are constants determined only by n and k independent of the unknown quantity. Therefore, for a given n, MSE is determined only by k up to. Table 5 shows these values for and. We find that a larger k yields a smaller bias, whereas the variance of the OLS estimator attains the minimum value when as a result of the trade-off. Based on the above findings, we propose an optimal trimming rule based on the minimum MSE principle. When gives the optimal trimming and we attain an efficiency gain of approximately 33 percent. We note that the best trimming points depend only on n because where C and D depend only on n and k. Table 6 mentions the best trimming points for some n. As expected, we should exclude more observations for larger sample sizes. 
This section provides empirical applications of the theory discussed in the previous sections. We re-examine the OLS results shown in Soo (2005). He used city and urban agglomeration data for various countries, obtained from the following website: Thomas Brinkhoff (2004): City Population Soo estimated the coefficients in (5) and (6) by using OLS and the Hill estimator for both cities and urban agglomerations, and provided an excellent analysis on the reason for the dispersion of the estimated values of. Because he had noticed the possible bias and problem regarding OLS under Pareto distribution (Soo, 2005, page 244, section 3.2), he used the Hill estimator together with OLS. 
Here, we use the updated data available from the above-mentioned website and re-estimate the coefficients of these two equations, and examine how the results would change if we adopt our theory. We use the urban agglomeration data so that the results here can be compared with the results for urban agglomerations provided in Soo (2005, page 253, Table 4). In his results (based on the usual t test), the estimated values of  are significantly different from −1 for 18 of 26 countries. Moreover, non-Pareto behavior was observed for 13 of 26 countries. 
The OLS estimates for (5) are reported in Table 7. Since the updated data are unavailable for Morocco and Ecuador, the results for 24 countries are provided. The second column describes the number of agglomerations. The third and fourth columns represent the estimated values of  and the t values associated with the rank-size rule null. The fifth column describes the significance based on the usual t distribution. The last column shows the significance based on the true distribution of the t statistic obtained by Monte Carlo. Here, ∗, ∗∗, and ∗ ∗∗ imply that is considered to be different from −1 at the significance levels of 10 percent, 5 percent, and 1 percent, respectively. If we use the usual t distribution, the rank-size rule null is strongly rejected (in fact, it is rejected for 23 out of 24 countries). However, based on the true distribution, it is rejected for only one country (at the significance level of 5 percent), Australia, implying that the data are not inconsistent with the rank-size rule. Although estimates for countries such as Argentina, Colombia, and Jordan are quite different from −1, the rank-size rule is not rejected for them. We may understand that this is due to the smaller sample sizes. 
It is worth pointing out that our results are highly consistent with those obtained by using the asymptotic normality test a la Gabaix and Ibragimov (2006). In fact, under the asymptotic normality test, the rank-size rule is rejected for only one country (Bangladesh) at the significance level of 5 percent. Under both of our and Gabaix and Ibragimov (2006) tests, the rank-size rule is rejected for no countries at the significance level of 1 percent. 
Similarly, OLS estimates for (6) are reported in Table 8. Here, the fifth and sixth columns show the estimated coefficients for the non-linear term and the t values associated with it. In this case, ∗, ∗∗, and ∗∗∗ imply that is considered to be different from zero at the significance levels of 10 percent, 5 percent, and 1 percent, respectively. Similarly to the results obtained in Soo (2005), a strong tendency for non-Pareto behavior is observed if we use the usual t distribution (non-linearity for 19 out of 24 countries). Again, based on the true distribution, the non-linearity is observed for only 7 of 24 counties. In summary, under the true distribution, the conclusion favors the rank-size rule. 
Table 9 shows the results of trimmed OLS regressions. Here, based on the optimal trimming rule described in the previous section, we estimate in (1) and take its reciprocal to obtain the estimated value of. The first column gives the optimal trimming numbers and the second column describes the estimated values of. We can see that the trimmed OLS gives slightly smaller estimated values of in absolute value than does the usual OLS. This tendency is also observed in the comparison of estimated values by using OLS with those by using the Hill estimator in Soo (2005). As we can see from Table 8 that in most cases, the quadratic term is negative. This indicates that the largest cities are smaller than would be predicted by the rank-size rule, which implies that removing these cities leads to lower values of the coefficient.
OLS estimation and the t test have often been used in order to examine the rank-size rule and Zipf’s law for city sizes. We investigated the statistical properties of least squares estimators for the rank-size rule regression of city size under the Pareto distribution. We obtained the accurate and approximate expressions of the bias and variance of OLS estimator for the coefficient of log(rank). By means of Monte Carlo simulation, we also obtained the distribution of the t statistic, where we found that the t statistic does not have the t distribution. We also obtained some evidence of severe size distortions upon a mechanical application of the t test. Moreover, by Monte Carlo, we obtained the critical regions for the rank-size rule null and for non-Pareto behavior. These results can be referred to when we use OLS in rank-size regression as well as when we examine the existing studies on this subject. 
Based on the above findings, we propose to apply a trimmed least squares method, which works well for OLS. Evidently, when we are certain of the Pareto assumption, GLS and MLE are the best estimation procedures, but otherwise, OLS has an advantage from the point of view of robustness (see Gabaix and Ibragimov, 2006). Further, we believe that the trimmed OLS may have a good performance because log S should still have a larger variance for smaller i even if the underlying distribution is not Pareto. 
We can approach to the non-Pareto distribution case semiparametrically as in the Hill estimator and its successors, where only the tail shape of the distribution is parameterized. Naturally, only larger observations should be used for the statistical inference in this framework. The most difficult problem in this approach is how to determine the cut-off point or the number of observations that are effective for the inference. For this purpose, only the first-order properties do not suffice, and we need to obtain their semiparametric higher order properties as in e.g., Nishiyama and Robinson (2000) for semiparametric averaged derivatives case. Further research in these directions is currently underway. 

